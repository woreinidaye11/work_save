<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://hiakkaoyri1220.com</id>
    <title>hiakriggg</title>
    <updated>2024-06-20T10:53:07.514Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://hiakkaoyri1220.com"/>
    <link rel="self" href="https://hiakkaoyri1220.com/atom.xml"/>
    <subtitle>ak+q upupup</subtitle>
    <logo>https://hiakkaoyri1220.com/images/avatar.png</logo>
    <icon>https://hiakkaoyri1220.com/favicon.ico</icon>
    <rights>All rights reserved 2024, hiakriggg</rights>
    <entry>
        <title type="html"><![CDATA[MCC]]></title>
        <id>https://hiakkaoyri1220.com/post/mcc/</id>
        <link href="https://hiakkaoyri1220.com/post/mcc/">
        </link>
        <updated>2024-04-19T10:16:53.000Z</updated>
        <content type="html"><![CDATA[<h2 id="basic">Basic</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1713513304572.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713512095736.png" alt="" loading="lazy"><br>
Two vectors <strong>u,v</strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">≠</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">\ne o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">o</span></span></span></span> are said to be orthogonal or perpendicular if the angle between them is a right angle. This is true iff <strong>u . v = 0</strong><br>
<img src="https://hiakkaoyri1220.com/post-images/1713512574803.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713512885076.png" alt="" loading="lazy"><br>
For vectors a and b in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>a</mi><mo>×</mo><mi>b</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">R^2, ||a × b||</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord">∣</span><span class="mord">∣</span></span></span></span> gives the area of the parallelogram generated from the vectors a and b.<br>
For vectors a, b and c in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>R</mi><mn>3</mn></msup><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi>a</mi><mo separator="true">⋅</mo><mo>(</mo><mi>b</mi><mo>×</mo><mi>c</mi><mo>)</mo><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">R^3, |a · (b × c)|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mord">∣</span></span></span></span> gives the volume of the parallelepiped generated from the vectors a,b and c. From this interpretation,it is clear that the ordering of a, b and c in the triple scalar product does not matter; this is clear from the definition as well (interchanging rows of a determinant does not change the absolute value of the result).</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[mathmatics statistics]]></title>
        <id>https://hiakkaoyri1220.com/post/mathmatics-statistics/</id>
        <link href="https://hiakkaoyri1220.com/post/mathmatics-statistics/">
        </link>
        <updated>2024-03-04T10:29:39.000Z</updated>
        <content type="html"><![CDATA[<h1 id="week-1">Week 1</h1>
<h2 id="univariate-transformations">Univariate transformations</h2>
<figure data-type="image" tabindex="1"><img src="https://hiakkaoyri1220.com/post-images/1709359353125.png" alt="" loading="lazy"></figure>
<h3 id="one-to-one-transformation">One to one transformation</h3>
<figure data-type="image" tabindex="2"><img src="https://hiakkaoyri1220.com/post-images/1709359466508.png" alt="" loading="lazy"></figure>
<h4 id="change-to-the-variable-method-discrete-case">Change to the variable method - discrete case</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1709360068226.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709360486903.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709361714772.png" alt="" loading="lazy"></p>
<h4 id="non-one-to-one-transformation">Non one to one transformation</h4>
<figure data-type="image" tabindex="3"><img src="https://hiakkaoyri1220.com/post-images/1709362519815.png" alt="" loading="lazy"></figure>
<h4 id="change-to-the-variable-method-continuous-case">Change to the variable method - Continuous case</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1709362545037.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709362994246.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709363241277.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709363811366.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709442948021.png" alt="" loading="lazy"><br>
it become constant because f(x) is a uniform distribution equal to 1<br>
<img src="https://hiakkaoyri1220.com/post-images/1709443310101.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709444300991.png" alt="" loading="lazy"></p>
<h5 id="non-monotonic-one">Non monotonic one</h5>
<p><img src="https://hiakkaoyri1220.com/post-images/1709519756781.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710170147971.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710170264996.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710170299865.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714551136939.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712111574259.png" alt="" loading="lazy"></p>
<h3 id="linear-transformation">Linear transformation</h3>
<figure data-type="image" tabindex="4"><img src="https://hiakkaoyri1220.com/post-images/1709520758601.png" alt="" loading="lazy"></figure>
<h3 id="summary-of-the-change-of-variable-method">Summary of the change of variable method</h3>
<h4 id="discrete">discrete</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1709520815046.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709520942569.png" alt="" loading="lazy"></p>
<h4 id="continuous">continuous</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1709521098733.png" alt="" loading="lazy"><br>
step 3 should be <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>(</mo><mi>Y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g^{-1}(Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span></p>
<h2 id="cdf-method">CDF method</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1709521171483.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709521759389.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709523609046.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709524115222.png" alt="" loading="lazy"></p>
<h3 id="the-inverse-cdf-method">The inverse CDF method</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709526625757.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709526829083.png" alt="" loading="lazy"></p>
<h3 id="summary-of-cdf-method">Summary of CDF method</h3>
<figure data-type="image" tabindex="5"><img src="https://hiakkaoyri1220.com/post-images/1709526923815.png" alt="" loading="lazy"></figure>
<h2 id="mgf-method">MGF method</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1709535095941.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709535224480.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709539202697.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709541473088.png" alt="" loading="lazy"></p>
<h3 id="summary-of-mgf-method">Summary of MGF method</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709541516699.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709541621173.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709541651044.png" alt="" loading="lazy"></p>
<h3 id="binomial-prove">binomial prove</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710326375137.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710326390716.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710326561431.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710326581158.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710326615473.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710328240947.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710328253555.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710328310237.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710328327273.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710328344336.png" alt="" loading="lazy"></p>
<h3 id="exponential-distribution">Exponential Distribution</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710329109723.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710329132715.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710329161127.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710329218230.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710329301012.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710329314646.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710329597798.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712114127277.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712114190782.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712115276308.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712115331648.png" alt="" loading="lazy"></p>
<h1 id="week2">Week2</h1>
<h2 id="jointmarginal-and-conditional-distributions">Joint,Marginal, and  Conditional Distributions</h2>
<figure data-type="image" tabindex="6"><img src="https://hiakkaoyri1220.com/post-images/1709542510961.png" alt="" loading="lazy"></figure>
<h3 id="joint-distribution-discrete-case">joint distribution discrete case</h3>
<figure data-type="image" tabindex="7"><img src="https://hiakkaoyri1220.com/post-images/1709542535867.png" alt="" loading="lazy"></figure>
<h3 id="joint-distribution-continuous-case">joint distribution continuous case</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709542804537.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709547182222.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709547292460.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709547400005.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709547590333.png" alt="" loading="lazy"></p>
<h3 id="discrete-distribution-example">discrete distribution example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709705474697.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709705602225.png" alt="" loading="lazy"></p>
<h3 id="continuous-joint-pf">Continuous joint PF</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709705705736.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709705850639.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710340018447.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710340291231.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710340318409.png" alt="" loading="lazy"></p>
<h3 id="marginal-distributions">Marginal distributions</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710340946307.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710649126770.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711603325269.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710649622402.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710649718289.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710649916692.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710650111618.png" alt="" loading="lazy"></p>
<h2 id="independence-covariance-correlation">Independence, Covariance, correlation</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1710650199014.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710650483220.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710650841513.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710651093678.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710686919867.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710686957807.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710686988933.png" alt="" loading="lazy"></p>
<h3 id="example">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710687022382.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710687035802.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710687107251.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710687125483.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710687181755.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710687218863.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710687325057.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710687358814.png" alt="" loading="lazy"></p>
<h2 id="moments-of-multivariate-rvs">Moments of multivariate RVs</h2>
<figure data-type="image" tabindex="8"><img src="https://hiakkaoyri1220.com/post-images/1710651687341.png" alt="" loading="lazy"></figure>
<h3 id="linear-combinations">Linear combinations</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710651778490.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710651837783.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710651938881.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711782257259.png" alt="" loading="lazy"></p>
<h3 id="property-of-correlation-coefficient">property of correlation coefficient</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710652754491.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710652878743.png" alt="" loading="lazy"></p>
<h3 id="trivariate-case">trivariate case</h3>
<figure data-type="image" tabindex="9"><img src="https://hiakkaoyri1220.com/post-images/1710653039356.png" alt="" loading="lazy"></figure>
<h2 id="conditional-expectation">Conditional expectation</h2>
<figure data-type="image" tabindex="10"><img src="https://hiakkaoyri1220.com/post-images/1710654210585.png" alt="" loading="lazy"></figure>
<h3 id="the-law-of-total-expectation">The law of total expectation</h3>
<figure data-type="image" tabindex="11"><img src="https://hiakkaoyri1220.com/post-images/1710654350656.png" alt="" loading="lazy"></figure>
<h4 id="example-2">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1710654449205.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710654499843.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710654533921.png" alt="" loading="lazy"></p>
<h2 id="conditional-variance">Conditional variance</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1710686156512.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710686375691.png" alt="" loading="lazy"><br>
using product rule<br>
<img src="https://hiakkaoyri1220.com/post-images/1710686442665.png" alt="" loading="lazy"></p>
<h2 id="joint-mgf">Joint MGF</h2>
<figure data-type="image" tabindex="12"><img src="https://hiakkaoyri1220.com/post-images/1710686484741.png" alt="" loading="lazy"></figure>
<h2 id="cross-moments">Cross moments</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1710686529661.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710686598156.png" alt="" loading="lazy"></p>
<h1 id="week3">Week3</h1>
<p><img src="https://hiakkaoyri1220.com/post-images/1710464256800.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710464488199.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710464567310.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710464768703.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710465065725.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710465125053.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710465220555.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710465471368.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710465772423.png" alt="" loading="lazy"></p>
<h2 id="continuous-2">Continuous</h2>
<h3 id="uniform-distribution-on-the-unit-square">Uniform distribution on the unit square</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711802269642.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802291775.png" alt="" loading="lazy"></p>
<h3 id="dirichlet-distribution">Dirichlet distribution</h3>
<figure data-type="image" tabindex="13"><img src="https://hiakkaoyri1220.com/post-images/1711802336042.png" alt="" loading="lazy"></figure>
<h3 id="multivariate-normal-distribution">Multivariate normal distribution</h3>
<figure data-type="image" tabindex="14"><img src="https://hiakkaoyri1220.com/post-images/1711802395939.png" alt="" loading="lazy"></figure>
<h3 id="bivariate-normal-distribution">Bivariate normal distribution</h3>
<figure data-type="image" tabindex="15"><img src="https://hiakkaoyri1220.com/post-images/1711802439352.png" alt="" loading="lazy"></figure>
<h3 id="properties-of-the-multivariate-normal-distributions">Properties of the multivariate normal distributions</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711802496175.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802716584.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802736623.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802750853.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802764529.png" alt="" loading="lazy"></p>
<h3 id="example-3">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711802822569.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802864778.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802905088.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802925499.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711803023658.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711802974532.png" alt="" loading="lazy"></p>
<h1 id="week4">Week4</h1>
<h2 id="propertis-of-variance-matrices">Propertis of variance matrices</h2>
<h3 id="summary-of-linear-combinations-and-transformations">Summary of Linear combinations and transformations</h3>
<figure data-type="image" tabindex="16"><img src="https://hiakkaoyri1220.com/post-images/1711810318385.png" alt="" loading="lazy"></figure>
<h3 id="positive-definite-matrix">Positive definite matrix</h3>
<figure data-type="image" tabindex="17"><img src="https://hiakkaoyri1220.com/post-images/1711810647312.png" alt="" loading="lazy"></figure>
<h4 id="variance-matrix">Variance matrix</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1711810870041.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711811019185.png" alt="" loading="lazy"></p>
<h3 id="degenerate-distribution">Degenerate distribution</h3>
<figure data-type="image" tabindex="18"><img src="https://hiakkaoyri1220.com/post-images/1711811135947.png" alt="" loading="lazy"></figure>
<h4 id="example-4">Example</h4>
<figure data-type="image" tabindex="19"><img src="https://hiakkaoyri1220.com/post-images/1711811294730.png" alt="" loading="lazy"></figure>
<h2 id="multivariate-transiform">Multivariate transiform</h2>
<h3 id="sum-of-two-random-variables">Sum of two random variables</h3>
<figure data-type="image" tabindex="20"><img src="https://hiakkaoyri1220.com/post-images/1710726842031.png" alt="" loading="lazy"></figure>
<h4 id="proof">Proof</h4>
<figure data-type="image" tabindex="21"><img src="https://hiakkaoyri1220.com/post-images/1710727008317.png" alt="" loading="lazy"></figure>
<h3 id="example-5">Example</h3>
<figure data-type="image" tabindex="22"><img src="https://hiakkaoyri1220.com/post-images/1710727308862.png" alt="" loading="lazy"></figure>
<h2 id="continuous-3">Continuous</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1710727435635.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710727693784.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710728043768.png" alt="" loading="lazy"></p>
<h3 id="ratio-of-two-random-variables">Ratio of two random variables</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710728107331.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711869579026.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711869649038.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711946792148.png" alt="" loading="lazy"></p>
<h3 id="product-of-two-random-variables">Product of two random variables</h3>
<figure data-type="image" tabindex="23"><img src="https://hiakkaoyri1220.com/post-images/1710728215085.png" alt="" loading="lazy"></figure>
<h2 id="summary">Summary</h2>
<figure data-type="image" tabindex="24"><img src="https://hiakkaoyri1220.com/post-images/1710728260531.png" alt="" loading="lazy"></figure>
<h2 id="multivariate">multivariate</h2>
<h3 id="bivariate-transfrmation">Bivariate Transfrmation</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710728360574.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710728618349.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710728630913.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710728761987.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710728806503.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710728911119.png" alt="" loading="lazy"></p>
<h4 id="example-6">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1711955996754.png" alt="" loading="lazy"><br>
det(H) = |ad - bc|<br>
<img src="https://hiakkaoyri1220.com/post-images/1711946464727.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711956812105.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711957243797.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711957426947.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711965465188.png" alt="" loading="lazy"></p>
<h3 id="regular-transformation-method">Regular Transformation method</h3>
<figure data-type="image" tabindex="25"><img src="https://hiakkaoyri1220.com/post-images/1711965563709.png" alt="" loading="lazy"></figure>
<h4 id="example-7">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1711965663700.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711965866291.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711966036395.png" alt="" loading="lazy"></p>
<h3 id="mgf-method-2">MGF method</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711966135470.png" alt="" loading="lazy"><br>
proof<br>
<img src="https://hiakkaoyri1220.com/post-images/1711966240581.png" alt="" loading="lazy"></p>
<h4 id="example-8">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1711966314753.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711968559286.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711968825226.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711968887165.png" alt="" loading="lazy"></p>
<h1 id="week5">Week5</h1>
<h2 id="convergence-and-limit-theorems">Convergence and Limit Theorems</h2>
<h3 id="convergence-of-real-numbers">Convergence of real numbers</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714807523035.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711968987104.png" alt="" loading="lazy"></p>
<h3 id="convergence-of-random-variables">Convergence of random variables</h3>
<figure data-type="image" tabindex="26"><img src="https://hiakkaoyri1220.com/post-images/1711969231155.png" alt="" loading="lazy"></figure>
<h3 id="convergence-in-distribution">Convergence in distribution</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711969425220.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711969504100.png" alt="" loading="lazy"></p>
<h4 id="example-9">Example</h4>
<figure data-type="image" tabindex="27"><img src="https://hiakkaoyri1220.com/post-images/1711979686720.png" alt="" loading="lazy"></figure>
<h3 id="convergence-in-probability">Convergence in probability</h3>
<figure data-type="image" tabindex="28"><img src="https://hiakkaoyri1220.com/post-images/1711979987059.png" alt="" loading="lazy"></figure>
<h4 id="example-10">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1711980144795.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711981333382.png" alt="" loading="lazy"></p>
<h3 id="convergence-in-quadratic-mean">Convergence in quadratic mean</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711981467773.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711982983653.png" alt="" loading="lazy"></p>
<h4 id="example-11">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712028342255.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712028392192.png" alt="" loading="lazy"></p>
<h3 id="almost-sure-convergence">Almost sure convergence</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712028506307.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712030889078.png" alt="" loading="lazy"><br>
using cdf -&gt; 1- 1/m = m-1/m</p>
<h3 id="summary-2">Summary</h3>
<figure data-type="image" tabindex="29"><img src="https://hiakkaoyri1220.com/post-images/1712030965902.png" alt="" loading="lazy"></figure>
<h3 id="mode-of-convergence">Mode of convergence</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712030991610.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712031580905.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712031774927.png" alt="" loading="lazy"></p>
<h3 id="remark">Remark</h3>
<figure data-type="image" tabindex="30"><img src="https://hiakkaoyri1220.com/post-images/1712031524062.png" alt="" loading="lazy"></figure>
<h3 id="weak-law-of-large-numbers">Weak law of large numbers</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712054570842.png" alt="" loading="lazy"><br>
proof<br>
<img src="https://hiakkaoyri1220.com/post-images/1712054773078.png" alt="" loading="lazy"></p>
<h3 id="strong-law-of-large-numbers">Strong law of large numbers</h3>
<figure data-type="image" tabindex="31"><img src="https://hiakkaoyri1220.com/post-images/1712054916832.png" alt="" loading="lazy"></figure>
<h2 id="central-limit-theorem">Central limit Theorem</h2>
<h3 id="continuity-theorem">Continuity Theorem</h3>
<figure data-type="image" tabindex="32"><img src="https://hiakkaoyri1220.com/post-images/1712055121847.png" alt="" loading="lazy"></figure>
<h3 id="statement-of-clt">statement of CLT</h3>
<figure data-type="image" tabindex="33"><img src="https://hiakkaoyri1220.com/post-images/1712055261029.png" alt="" loading="lazy"></figure>
<h3 id="remakes">Remakes</h3>
<ul>
<li>The CLT is an important and powerful result, a pillar of theoretical statistics as it allows us to describe the behavior of the sample mean regardless of the parent distribution</li>
<li>The CLT is the major reason for the importance of the normal distribution</li>
<li>Notice that any statistic defined as a sum of values of a RV divided by the number of values can be considered as a mean, e.g.</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mn>2</mn></msup><mtext> and </mtext><mover accent="true"><mi>p</mi><mo>^</mo></mover><mtext>(the sample proportion)</mtext></mrow><annotation encoding="application/x-tex">\overline{x}^2   \text{                and         }    \hat{p} \text{(the sample proportion)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord"> and </span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mord text"><span class="mord">(the sample proportion)</span></span></span></span></span></span></p>
<h4 id="the-exponential-functionimportant-limit">The exponential function(important limit)</h4>
<p>That is</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><munder><mi>lim</mi><mo>⁡</mo><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mo>(</mo><mn>1</mn><mo>+</mo><mfrac><mi>k</mi><mi>n</mi></mfrac><msup><mo>)</mo><mi>n</mi></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>n</mi><mi>k</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \lim_{n \to \infty} (1+\frac{k}{n})^n = e^{nk}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.45em;vertical-align:-0.7em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.1em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<figure data-type="image" tabindex="34"><img src="https://hiakkaoyri1220.com/post-images/1712055683366.png" alt="" loading="lazy"></figure>
<h4 id="proof-2">Proof</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712056622549.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712069923103.png" alt="" loading="lazy"><br>
it conclude that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">Z_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the linear combination of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> RV<br>
<img src="https://hiakkaoyri1220.com/post-images/1712070267659.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712070423651.png" alt="" loading="lazy"></p>
<h4 id="remark-2">Remark</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712070527107.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712070637148.png" alt="" loading="lazy"></p>
<h4 id="example-12">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712071098282.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712071167969.png" alt="" loading="lazy"></p>
<h1 id="week6">Week6</h1>
<h2 id="statistical-inference">Statistical Inference</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1714894813498.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714894909720.png" alt="" loading="lazy"></p>
<h3 id="estimation-and-estimators">Estimation and estimators</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714895053508.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714895292366.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714895418278.png" alt="" loading="lazy"></p>
<h3 id="frequentist-vs-bayesian">Frequentist vs Bayesian</h3>
<figure data-type="image" tabindex="35"><img src="https://hiakkaoyri1220.com/post-images/1714895664233.png" alt="" loading="lazy"></figure>
<h3 id="types-of-estimators">Types of estimators</h3>
<figure data-type="image" tabindex="36"><img src="https://hiakkaoyri1220.com/post-images/1714895681971.png" alt="" loading="lazy"></figure>
<h3 id="properties-of-point-estimators">Properties of point estimators</h3>
<figure data-type="image" tabindex="37"><img src="https://hiakkaoyri1220.com/post-images/1714895786537.png" alt="" loading="lazy"></figure>
<h2 id="bias">Bias</h2>
<h3 id="definition">Definition</h3>
<figure data-type="image" tabindex="38"><img src="https://hiakkaoyri1220.com/post-images/1714895813432.png" alt="" loading="lazy"></figure>
<h3 id="example-13">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714896488099.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714896472791.png" alt="" loading="lazy"></p>
<h3 id="some-common-unbiased-point-estimators">Some common unbiased point estimators</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714918040801.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714918155760.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714918274917.png" alt="" loading="lazy"></p>
<h3 id="mse">MSE</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714918358931.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714918780930.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714918830220.png" alt="" loading="lazy"></p>
<h3 id="msebias-and-variance">MSE,bias and variance</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714918930235.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714918947782.png" alt="" loading="lazy"></p>
<h3 id="minimising-mse">Minimising MSE</h3>
<figure data-type="image" tabindex="39"><img src="https://hiakkaoyri1220.com/post-images/1714919077248.png" alt="" loading="lazy"></figure>
<h4 id="uniformly-minimum-mse-estimator">Uniformly minimum MSE estimator</h4>
<figure data-type="image" tabindex="40"><img src="https://hiakkaoyri1220.com/post-images/1714919105920.png" alt="" loading="lazy"></figure>
<h2 id="efficiency">Efficiency</h2>
<h3 id="relative-efficiency">Relative efficiency</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714919191969.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714927030353.png" alt="" loading="lazy"></p>
<h3 id="example-14">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714927061075.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714928506882.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714928666767.png" alt="" loading="lazy"></p>
<h3 id="minimum-variance-unbiased-estimatormvue">Minimum variance unbiased estimator(MVUE)</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714965325970.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714965344473.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714965719629.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714965886611.png" alt="" loading="lazy"></p>
<h3 id="finding-an-mvue">Finding an MVUE</h3>
<figure data-type="image" tabindex="41"><img src="https://hiakkaoyri1220.com/post-images/1714965905503.png" alt="" loading="lazy"></figure>
<h3 id="likelihood-score-and-fisher-information">Likelihood, score and Fisher information</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714966052027.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714966156808.png" alt="" loading="lazy"></p>
<h3 id="the-score">The score</h3>
<figure data-type="image" tabindex="42"><img src="https://hiakkaoyri1220.com/post-images/1714966329753.png" alt="" loading="lazy"></figure>
<h3 id="fisher-information">Fisher information</h3>
<figure data-type="image" tabindex="43"><img src="https://hiakkaoyri1220.com/post-images/1714966424564.png" alt="" loading="lazy"></figure>
<h3 id="the-expected-socre">The expected socre</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714966493095.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715133937055.png" alt="" loading="lazy"></p>
<h3 id="variance-of-the-score">Variance of the score</h3>
<figure data-type="image" tabindex="44"><img src="https://hiakkaoyri1220.com/post-images/1715134037110.png" alt="" loading="lazy"></figure>
<h3 id="curvature-or-likelihood">Curvature or likelihood</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1715135159087.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715139283136.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715150357661.png" alt="" loading="lazy"></p>
<h2 id="remarks">Remarks</h2>
<figure data-type="image" tabindex="45"><img src="https://hiakkaoyri1220.com/post-images/1715150633738.png" alt="" loading="lazy"></figure>
<h4 id="example-15">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1715150837228.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715151200838.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715154170275.png" alt="" loading="lazy"></p>
<h3 id="cramer-rao-lower-boundcrlb">Cramer-Rao lower bound(CRLB)</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1715154206186.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715177664787.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715177940023.png" alt="" loading="lazy"></p>
<h4 id="remark-about-crlb">Remark about CRLB</h4>
<figure data-type="image" tabindex="46"><img src="https://hiakkaoyri1220.com/post-images/1715259227875.png" alt="" loading="lazy"></figure>
<h4 id="example-16">Example</h4>
<figure data-type="image" tabindex="47"><img src="https://hiakkaoyri1220.com/post-images/1715262136251.png" alt="" loading="lazy"></figure>
<h3 id="estimators-that-achieve-the-crlb">Estimators that achieve the CRLB</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1715262514893.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715262741843.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715262799914.png" alt="" loading="lazy"></p>
<h4 id="example-17">Example</h4>
<figure data-type="image" tabindex="48"><img src="https://hiakkaoyri1220.com/post-images/1715263038709.png" alt="" loading="lazy"></figure>
<h3 id="exponential-families">Exponential families</h3>
<figure data-type="image" tabindex="49"><img src="https://hiakkaoyri1220.com/post-images/1715263155871.png" alt="" loading="lazy"></figure>
<h4 id="exponential-families-and-mvue">Exponential families and MVUE</h4>
<figure data-type="image" tabindex="50"><img src="https://hiakkaoyri1220.com/post-images/1715263790378.png" alt="" loading="lazy"></figure>
<h4 id="example-18">Example</h4>
<figure data-type="image" tabindex="51"><img src="https://hiakkaoyri1220.com/post-images/1715263937104.png" alt="" loading="lazy"></figure>
<h1 id="week-7">Week 7</h1>
<h2 id="consistency">Consistency</h2>
<h3 id="consistent-estimator">Consistent estimator</h3>
<figure data-type="image" tabindex="52"><img src="https://hiakkaoyri1220.com/post-images/1715328354864.png" alt="" loading="lazy"></figure>
<h3 id="a-sufficient-condition-for-consistency">A sufficient condition for consistency</h3>
<figure data-type="image" tabindex="53"><img src="https://hiakkaoyri1220.com/post-images/1715328446875.png" alt="" loading="lazy"></figure>
<h3 id="consistency-for-unbiased-estimator">Consistency for unbiased estimator</h3>
<p>If <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>θ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9578799999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span></span></span></span> is an unbiased estimator, then its MSE equals its variance. Thus, for an unbiased <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>θ</mi><mi>n</mi></msub><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\theta_n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1078799999999998em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>, if var<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mover accent="true"><msub><mi>θ</mi><mi>n</mi></msub><mo>^</mo></mover><mo>)</mo><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(\hat{\theta_n}) \to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2078799999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">n \to \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span>, then it is a consistent estimator of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></p>
<h3 id="example-19">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1715329027200.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715329038292.png" alt="" loading="lazy"></p>
<h2 id="sufficient">Sufficient</h2>
<h3 id="sufficient-statistic">Sufficient statistic</h3>
<figure data-type="image" tabindex="54"><img src="https://hiakkaoyri1220.com/post-images/1715412776398.png" alt="" loading="lazy"></figure>
<h4 id="example-20">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1715413522648.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715413539495.png" alt="" loading="lazy"></p>
<h3 id="factorization-theorem">Factorization Theorem</h3>
<figure data-type="image" tabindex="55"><img src="https://hiakkaoyri1220.com/post-images/1715413609738.png" alt="" loading="lazy"></figure>
<h4 id="proof-3">Proof</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1715413995376.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715414010630.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715414354183.png" alt="" loading="lazy"></p>
<h4 id="example-21">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1715414642028.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715492953645.png" alt="" loading="lazy"></p>
<h3 id="factorization-therorem-for-two-parameters">Factorization Therorem for two parameters</h3>
<figure data-type="image" tabindex="56"><img src="https://hiakkaoyri1220.com/post-images/1715493129148.png" alt="" loading="lazy"></figure>
<h3 id="pitman-koopman-theorem">Pitman-Koopman Theorem</h3>
<figure data-type="image" tabindex="57"><img src="https://hiakkaoyri1220.com/post-images/1715493175175.png" alt="" loading="lazy"></figure>
<h4 id="example-joint-sufficiency">Example (joint sufficiency)</h4>
<figure data-type="image" tabindex="58"><img src="https://hiakkaoyri1220.com/post-images/1715493320678.png" alt="" loading="lazy"></figure>
<h3 id="rao-blackwell-theorem">Rao-Blackwell Theorem</h3>
<figure data-type="image" tabindex="59"><img src="https://hiakkaoyri1220.com/post-images/1715494867010.png" alt="" loading="lazy"></figure>
<h4 id="proof-4">Proof</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1715495084385.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715495220450.png" alt="" loading="lazy"></p>
<h4 id="remark-3">Remark</h4>
<figure data-type="image" tabindex="60"><img src="https://hiakkaoyri1220.com/post-images/1715495372859.png" alt="" loading="lazy"></figure>
<h4 id="example-22">Example</h4>
<figure data-type="image" tabindex="61"><img src="https://hiakkaoyri1220.com/post-images/1715495549392.png" alt="" loading="lazy"></figure>
<h5 id="remarks-on-example">remarks on example</h5>
<figure data-type="image" tabindex="62"><img src="https://hiakkaoyri1220.com/post-images/1715495594848.png" alt="" loading="lazy"></figure>
<h3 id="lehmann-scheffe-theorem">lehmann scheffe theorem</h3>
<p>If S is complete and sufficient, then for any unbiased T, E[T|S] is MVUE</p>
<h3 id="minimal-sufficiency">Minimal sufficiency</h3>
<figure data-type="image" tabindex="63"><img src="https://hiakkaoyri1220.com/post-images/1715495867627.png" alt="" loading="lazy"></figure>
<h3 id="finding-minimal-sufficient-statistic">Finding minimal sufficient statistic</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1715495979323.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715496295957.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715496310181.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715496485728.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715496552676.png" alt="" loading="lazy"></p>
<h4 id="remarks-on-minimal-sufficiency">Remarks on minimal sufficiency</h4>
<figure data-type="image" tabindex="64"><img src="https://hiakkaoyri1220.com/post-images/1715496619667.png" alt="" loading="lazy"></figure>
<h3 id="complete-statistic">Complete statistic</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1715496679404.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715493884606.png" alt="" loading="lazy"></p>
<h4 id="properties-of-complete-statistic">Properties of complete statistic</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1715496874157.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1715496896180.png" alt="" loading="lazy"></p>
<h3 id="complete-statistic-and-mvue">Complete statistic and MVUE</h3>
<figure data-type="image" tabindex="65"><img src="https://hiakkaoyri1220.com/post-images/1715497045671.png" alt="" loading="lazy"></figure>
<h2 id="summary-of-good-estimator">Summary of good estimator</h2>
<figure data-type="image" tabindex="66"><img src="https://hiakkaoyri1220.com/post-images/1715497207513.png" alt="" loading="lazy"></figure>
<h3 id="finding-an-mvue-2">Finding an MVUE</h3>
<figure data-type="image" tabindex="67"><img src="https://hiakkaoyri1220.com/post-images/1715497242852.png" alt="" loading="lazy"></figure>
<h1 id="week-8">Week 8</h1>
<h3 id="methods-of-estimation">Methods of Estimation</h3>
<figure data-type="image" tabindex="68"><img src="https://hiakkaoyri1220.com/post-images/1716100077403.png" alt="" loading="lazy"></figure>
<h2 id="the-methods-of-moment">The methods of moment</h2>
<h3 id="introdution">Introdution</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1716100124058.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1716100202147.png" alt="" loading="lazy"></p>
<h3 id="properties-of-mme">Properties of MME</h3>
<figure data-type="image" tabindex="69"><img src="https://hiakkaoyri1220.com/post-images/1716100238914.png" alt="" loading="lazy"></figure>
<h3 id="example-23">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1716101175573.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1716101254296.png" alt="" loading="lazy"></p>
<h3 id="non-uniqueness-of-mme">non-uniqueness of MME</h3>
<figure data-type="image" tabindex="70"><img src="https://hiakkaoyri1220.com/post-images/1716100331269.png" alt="" loading="lazy"></figure>
<h3 id="example-of-non-uniqueness">Example of non-uniqueness</h3>
<figure data-type="image" tabindex="71"><img src="https://hiakkaoyri1220.com/post-images/1716101595399.png" alt="" loading="lazy"></figure>
<h2 id="the-methods-of-maximum-likelihood">The methods of maximum likelihood</h2>
<h3 id="introduction">Introduction</h3>
<figure data-type="image" tabindex="72"><img src="https://hiakkaoyri1220.com/post-images/1716100419591.png" alt="" loading="lazy"></figure>
<h3 id="example-24">example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1716184664703.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1716185928715.png" alt="" loading="lazy"></p>
<h2 id="properties-of-mle">Properties of MLE</h2>
<figure data-type="image" tabindex="73"><img src="https://hiakkaoyri1220.com/post-images/1716186547397.png" alt="" loading="lazy"></figure>
<h3 id="invariance-under-transformation-of-data">Invariance under transformation of data</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1716186783951.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1716187035824.png" alt="" loading="lazy"></p>
<h4 id="example-25">Example</h4>
<h3 id="mle-and-sufficient-statistics">MLE and sufficient statistics</h3>
<figure data-type="image" tabindex="74"><img src="https://hiakkaoyri1220.com/post-images/1716187767094.png" alt="" loading="lazy"></figure>
<h4 id="example-26">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1716187907331.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1716188053556.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[sm prac and workshop]]></title>
        <id>https://hiakkaoyri1220.com/post/sm-prac-and-workshop/</id>
        <link href="https://hiakkaoyri1220.com/post/sm-prac-and-workshop/">
        </link>
        <updated>2024-03-03T14:24:55.000Z</updated>
        <content type="html"><![CDATA[<h1 id="p1w1">P1&amp;&amp;W1</h1>
<h3 id="delim">Delim</h3>
<pre><code>clams &lt;- read_delim('./data/ZuurData/Clams.txt')
</code></pre>
<p>from tidyverse, it will infer the delimitor,e.g, the txt file all separate with 1 or 3 or 5 special character(space)</p>
<h3 id="clean-up-name">Clean up name</h3>
<pre><code>janitor::clean_names(clams)
</code></pre>
<p>convert column name into lower case</p>
<h3 id="change-column-name-and-type">change column name and type</h3>
<pre><code>clams &lt;- transmute(clams,
month = as_factor(month), length, #keep these columns
weight = afd, #rename the following columns
log_length = lnlength,
log_weight = lnafd
)
</code></pre>
<h3 id="wrap-a-1d-sequence-of-panels-into-2d对某个变量建图">wrap a 1d sequence of panels into 2d（对某个变量建图）</h3>
<pre><code>ggplot(clams,aes(length,weight))+geom_point()+facet_wrap(~month)
</code></pre>
<h3 id="use-drop1-to-see-if-the-interaction-is-significant">use <code>drop1</code> to see if the interaction is significant</h3>
<pre><code>drop1(model_interact, test = &quot;F&quot;)
</code></pre>
<p>lower Pr(F) is more significant</p>
<h3 id="increase-row-number-reduce-column-number">increase row number reduce column number</h3>
<pre><code>pivot_longer(-c(tens,hard))
</code></pre>
<p>except for the variable <strong>tens and hard</strong></p>
<h4 id="example-in-prac">Example in prac</h4>
<figure data-type="image" tabindex="1"><img src="https://hiakkaoyri1220.com/post-images/1711089464316.png" alt="" loading="lazy"></figure>
<h3 id="split-two-plot-base-on-name">split two plot base on name</h3>
<figure data-type="image" tabindex="2"><img src="https://hiakkaoyri1220.com/post-images/1711089590868.png" alt="" loading="lazy"></figure>
<h2 id="fit">fit</h2>
<figure data-type="image" tabindex="3"><img src="https://hiakkaoyri1220.com/post-images/1711089761199.png" alt="" loading="lazy"></figure>
<h2 id="important-assumption-checking">Important assumption checking</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1711090595094.png" alt="" loading="lazy"><br>
The residuals are roughly randomly scattered about the zero line in the residuals versus fitted values plot, apart from slight curvature near the endpoints. The residuals versus hardness plot shows a random scatter<br>
but the slight curvature is apparent in the residuals versus tensile strength plot. On balance, the linearity assumption is close to reasonable.</p>
<p>The spread about the zero line appears roughly constant in all three plots indicating that the assumption of constant variance is reasonable.</p>
<p>There is some departure from normality in the lower tail of the distribution of residuals, with more large negative residuals than expected for a normal distribution. The bulk of the data is close to normally distributed however</p>
<p><strong>Linearity</strong> by checking the residuals vs fitted value, if it looks like random scatter point, then it is linearity<br>
<strong>Homoscedasticity</strong> or constant variance by checking Scale-location, if it looks like some patterns like increasing or decreasing, then it is not Homoscedasticity, need to improve the model<br>
<strong>normality of residuals</strong> by cheking normal-qq-plot, if almost all points lie on the line, then we can say it is normally distribution. outliers may indicate some question</p>
<h3 id="predict">Predict</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711163645723.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711163655137.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711163676858.png" alt="" loading="lazy"><br>
confidence is the average range we will have, prediction is the individual range we will have<br>
<img src="https://hiakkaoyri1220.com/post-images/1711163688268.png" alt="" loading="lazy"></p>
<h3 id="solve-equation">solve equation</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711163963361.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711163993983.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711164216609.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711164227807.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711164305504.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711164401236.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711164410480.png" alt="" loading="lazy"></p>
<h1 id="t1">T1</h1>
<p><img src="https://hiakkaoyri1220.com/post-images/1711087804871.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718159336856.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718159642906.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711087813700.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711087826503.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711087856465.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711087900824.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711088518649.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711088504325.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711088659705.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711088887467.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711088957777.png" alt="" loading="lazy"></p>
<h1 id="p2">P2</h1>
<h2 id="normal-one">normal one</h2>
<pre><code>loan_lm1 &lt;- lm (loan_amnt ~ home_ownership,data =loan)
</code></pre>
<p><img src="https://hiakkaoyri1220.com/post-images/1711166628718.png" alt="" loading="lazy"><br>
以第一个为对比，得到其他的，intercept为第一个的value</p>
<h3 id="plot">Plot</h3>
<pre><code>loan %&gt;%
ggplot(aes(annual_inc,loan_amnt,col = home_ownership))+
geom_point()+
geom_smooth(method = lm,se = FALSE,aes(group=1))
</code></pre>
<h2 id="change-lm-parameters">Change lm parameters</h2>
<pre><code>loan_lm2 &lt;- lm (loan_amnt ~ home_ownership,data =loan,contrasts = list(home_ownership = &quot;contr.sum&quot;))
</code></pre>
<p><img src="https://hiakkaoyri1220.com/post-images/1711166370277.png" alt="" loading="lazy"><br>
first level 0, second level 1, last level -1<br>
<img src="https://hiakkaoyri1220.com/post-images/1711166586916.png" alt="" loading="lazy"><br>
以最后一个为对比，得到其他的，intercept为所有value的平均值，要得到最后一个的value要减去所有的value才可以得到（因为是-1，-1）所以是13522-3663-(-4422)</p>
<h2 id="parallel-regerssion-with-different-intercept-same-slope">parallel regerssion with different intercept same slope</h2>
<pre><code>loan_lm3 &lt;- lm(loan_amnt ~ home_ownership+annual_inc,data = loan)
</code></pre>
<p><img src="https://hiakkaoyri1220.com/post-images/1711167126013.png" alt="" loading="lazy"><br>
slope is 0.1021<br>
<img src="https://hiakkaoyri1220.com/post-images/1711167137187.png" alt="" loading="lazy"></p>
<h3 id="broomaugment-get-extra-information">Broom::augment get extra information</h3>
<h3 id="plot-2">plot</h3>
<pre><code>broom::augment(loan_lm3) %&gt;%
ggplot(aes(annual_inc,loan_amnt,col = home_ownership))+
geom_point()+
geom_line(aes(y= .fitted),size =1))
</code></pre>
<h2 id="separate-regerssion-with-different-intercept-and-different-slope">separate regerssion with different intercept and different slope</h2>
<pre><code>loan_lm4 &lt;- lm(loan_amnt ~ home_ownership*annual_inc,data = loan)
</code></pre>
<p><img src="https://hiakkaoyri1220.com/post-images/1711167198086.png" alt="" loading="lazy"><br>
slope<br>
<img src="https://hiakkaoyri1220.com/post-images/1711167274851.png" alt="" loading="lazy"></p>
<h3 id="plot-3">plot</h3>
<pre><code>loan %&gt;%
  ggplot(aes(annual_inc,loan_amnt,col = home_ownership))+
  geom_point()+
  geom_smooth(method = lm,se = FALSE)
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://hiakkaoyri1220.com/post-images/1718380862350.png" alt="" loading="lazy"></figure>
<h2 id="which-model">Which model</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1711168097833.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711168107905.png" alt="" loading="lazy"><br>
anova compare the different between the model, if it is different, then parameter will appear, it p-value &gt; 0.05 than they are no differnet, pick the less one, else it is a very important model pick the more parameter one.</p>
<h3 id="get-residuals-and-studentized-residuals">get residuals and studentized residuals</h3>
<figure data-type="image" tabindex="5"><img src="https://hiakkaoyri1220.com/post-images/1712552535040.png" alt="" loading="lazy"></figure>
<h2 id="t2">T2</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1713246893770.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713247445105.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713246865861.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718525902191.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713247129331.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713247776706.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713248065417.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713248119418.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718527464294.png" alt="" loading="lazy"></p>
<h2 id="ass-1">Ass 1</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718536701626.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718536717357.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718536731640.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718536745838.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718536766388.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718536827668.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718536889164.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718536900159.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718537007394.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718537459433.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718538663377.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718538681023.png" alt="" loading="lazy"></p>
<h2 id="p3">P3</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718560511681.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718560525875.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718560539326.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718560570961.png" alt="" loading="lazy"></p>
<pre><code>hatvalues(hills_lm)
</code></pre>
<p>to get the leverage<br>
<img src="https://hiakkaoyri1220.com/post-images/1718561837705.png" alt="" loading="lazy"><br>
point 7 is the most influence point<br>
<img src="https://hiakkaoyri1220.com/post-images/1718561883988.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718561915961.png" alt="" loading="lazy"></p>
<h2 id="test-1">Test 1</h2>
<h2 id="t3">T3</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1713349852755.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713352025157.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713352083474.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713352104599.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718611746880.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713352155252.png" alt="" loading="lazy"></p>
<h2 id="p4">P4</h2>
<figure data-type="image" tabindex="6"><img src="https://hiakkaoyri1220.com/post-images/1718621625559.png" alt="" loading="lazy"></figure>
<h3 id="get-the-residuals">Get the residuals</h3>
<figure data-type="image" tabindex="7"><img src="https://hiakkaoyri1220.com/post-images/1718621761098.png" alt="" loading="lazy"></figure>
<h3 id="error-bar">error bar</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714454380762.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714454392942.png" alt="" loading="lazy"></p>
<h2 id="t4">T4</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718653860981.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718653873303.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718653989816.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718657130992.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718657155875.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718657166654.png" alt="" loading="lazy"></p>
<h2 id="p5">P5</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718670116514.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718670168010.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718670182047.png" alt="" loading="lazy"><br>
it means when we increase in age of 1 year, <strong>We multiple 0.99 for it</strong><br>
<img src="https://hiakkaoyri1220.com/post-images/1718670308849.png" alt="" loading="lazy"><br>
still have curved pattern in it,<br>
<img src="https://hiakkaoyri1220.com/post-images/1718670348743.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718670403060.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718670593699.png" alt="" loading="lazy"><br>
If the AIC is go within 2, then we go to the smallest model. Else pick the smallest AIC model</p>
<h2 id="t5">T5</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718693201109.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718693863402.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718714170399.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718714186596.png" alt="" loading="lazy"></p>
<h2 id="p6">P6</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718722969054.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718729610602.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718729619735.png" alt="" loading="lazy"><br>
find the biggest p-value and remove it<br>
<img src="https://hiakkaoyri1220.com/post-images/1718729720700.png" alt="" loading="lazy"><br>
for the backforward using AIC, we remove the smallest one. ,until <none> is the smallest<br>
<img src="https://hiakkaoyri1220.com/post-images/1718729775505.png" alt="" loading="lazy"><br>
forward using AIC<br>
<img src="https://hiakkaoyri1220.com/post-images/1718729829758.png" alt="" loading="lazy"></p>
<h3 id="stargazer">stargazer</h3>
<figure data-type="image" tabindex="8"><img src="https://hiakkaoyri1220.com/post-images/1718729903093.png" alt="" loading="lazy"></figure>
<h3 id="which-model-2">which model</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718729964987.png" alt="" loading="lazy"><br>
using cross-validation to determine which model, smaller the one we will use</p>
<h2 id="t6">T6</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718732030207.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718732309270.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718732322051.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718732498801.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718732509323.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Statistical Modelling ]]></title>
        <id>https://hiakkaoyri1220.com/post/statistical-modelling/</id>
        <link href="https://hiakkaoyri1220.com/post/statistical-modelling/">
        </link>
        <updated>2024-02-28T18:23:43.000Z</updated>
        <content type="html"><![CDATA[<h1 id="week1">Week1</h1>
<h2 id="linear-regression">Linear Regression</h2>
<h3 id="multiple-linear-regression">Multiple Linear Regression</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1708840156901.png" alt="" loading="lazy"><br>
upper case is random variables, lower case is observe variables</p>
<h3 id="random-vectors">Random vectors</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1708840274447.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1708840522875.png" alt="" loading="lazy"></p>
<h3 id="random-matrix">Random matrix</h3>
<figure data-type="image" tabindex="1"><img src="https://hiakkaoyri1220.com/post-images/1708840589458.png" alt="" loading="lazy"></figure>
<h3 id="linear-transformations">Linear transformations</h3>
<figure data-type="image" tabindex="2"><img src="https://hiakkaoyri1220.com/post-images/1708840623400.png" alt="" loading="lazy"></figure>
<h3 id="normal-distribution">Normal distribution</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709011902523.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709012061974.png" alt="" loading="lazy"></p>
<h2 id="mlr">MLR</h2>
<h3 id="multiple-regression">Multiple regression</h3>
<ul>
<li>The regression model is used to model the dependence between a predictor variable <em>x</em> and a response variaable <em><strong>Y</strong></em>.</li>
<li>In general, there may be several predictor variables <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>x</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">x_1,x_2, \cdots, x_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and single response <em><strong>Y</strong></em></li>
<li>In this case the <em>multiple regression</em> model may be used to model the simultaneous influence of the predictors</li>
</ul>
<h3 id="notation">Notation</h3>
<figure data-type="image" tabindex="3"><img src="https://hiakkaoyri1220.com/post-images/1709012728300.png" alt="" loading="lazy"></figure>
<h3 id="multiple-regression-model">Multiple regression model</h3>
<figure data-type="image" tabindex="4"><img src="https://hiakkaoyri1220.com/post-images/1709012800307.png" alt="" loading="lazy"></figure>
<h3 id="alternative-forms">Alternative forms</h3>
<figure data-type="image" tabindex="5"><img src="https://hiakkaoyri1220.com/post-images/1709012973540.png" alt="" loading="lazy"></figure>
<h3 id="matrix-formulation">Matrix formulation</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709013076784.png" alt="" loading="lazy"><br>
if it is normality, and two random variable their corvariance is 0,  then it is independent</p>
<h3 id="linear-independence">Linear Independence</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709013275522.png" alt="" loading="lazy"><br>
when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>v</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">v_1,v_2,\cdots,v_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> are linearly dependent it means that one of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>'s is expressible as a linear combination of the remaining <em><strong>v</strong></em>'s</p>
<h3 id="identifiability">Identifiability</h3>
<p>Consider the multiple regression mode</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>X</mi><mi>β</mi><mo>+</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">y= X\beta + e
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span></span></p>
<p>we require that the columns of <em>X</em> be linearly independent<br>
<img src="https://hiakkaoyri1220.com/post-images/1718026116157.png" alt="" loading="lazy"></p>
<h3 id="linear-least-squares">Linear least squares</h3>
<figure data-type="image" tabindex="6"><img src="https://hiakkaoyri1220.com/post-images/1709013966355.png" alt="" loading="lazy"></figure>
<h3 id="theorem-11">Theorem 1.1.</h3>
<p>If the columns of <em>X</em> are linearly independent then the least squares estimates are given uniquely by<br>
<img src="https://hiakkaoyri1220.com/post-images/1709014352682.png" alt="" loading="lazy"></p>
<h3 id="fitted-values">Fitted values</h3>
<figure data-type="image" tabindex="7"><img src="https://hiakkaoyri1220.com/post-images/1709014549411.png" alt="" loading="lazy"></figure>
<h3 id="alternative-notation">Alternative notation</h3>
<figure data-type="image" tabindex="8"><img src="https://hiakkaoyri1220.com/post-images/1709014590517.png" alt="" loading="lazy"></figure>
<h3 id="theorem-12">Theorem 1.2</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709014755142.png" alt="" loading="lazy"><br>
proof:<br>
<img src="https://hiakkaoyri1220.com/post-images/1709095385191.png" alt="" loading="lazy"><br>
it is an unbias estimator<br>
<img src="https://hiakkaoyri1220.com/post-images/1709358051874.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709358661644.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709358021942.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709358096943.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709358122938.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709358183119.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709358890566.png" alt="" loading="lazy"></p>
<h1 id="week2">Week2</h1>
<h3 id="estimable-functions-and-best-linear-unbiased-estimates">Estimable functions and best linear unbiased estimates</h3>
<figure data-type="image" tabindex="9"><img src="https://hiakkaoyri1220.com/post-images/1709870837511.png" alt="" loading="lazy"></figure>
<h3 id="estimable-function">estimable function</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1709870933212.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709871089027.png" alt="" loading="lazy"></p>
<h3 id="the-gauss-markov-theorem">The Gauss-Markov Theorem</h3>
<figure data-type="image" tabindex="10"><img src="https://hiakkaoyri1220.com/post-images/1709871109836.png" alt="" loading="lazy"></figure>
<h4 id="proof">Proof</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1709872010655.png" alt="" loading="lazy"><br>
due to the assumption we have, we know the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span> is not a zero vector, therefore we can subsitite in and become next step<br>
<img src="https://hiakkaoyri1220.com/post-images/1709872111366.png" alt="" loading="lazy"><br>
by times <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">(X^TX)^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> on both side to get <strong>P</strong><br>
<img src="https://hiakkaoyri1220.com/post-images/1709873472542.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709875379035.png" alt="" loading="lazy"><br>
as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>P</mi><mn>2</mn></msup><mo>=</mo><msup><mi>P</mi><mi>T</mi></msup><mo>=</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">P^2 = P^T = P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span></p>
<h3 id="inference-for-multiple-regression-regression-coefficients">Inference for multiple regression: regression coefficients</h3>
<figure data-type="image" tabindex="11"><img src="https://hiakkaoyri1220.com/post-images/1709876658018.png" alt="" loading="lazy"></figure>
<h3 id="pivotal-quantity">Pivotal quantity</h3>
<figure data-type="image" tabindex="12"><img src="https://hiakkaoyri1220.com/post-images/1709876685724.png" alt="" loading="lazy"></figure>
<h3 id="confidence-interval-for-beta_j">Confidence interval for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>β</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></h3>
<figure data-type="image" tabindex="13"><img src="https://hiakkaoyri1220.com/post-images/1709876813003.png" alt="" loading="lazy"></figure>
<h3 id="hypothesis-testing-for-beta_j">Hypothesis testing for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>β</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></h3>
<figure data-type="image" tabindex="14"><img src="https://hiakkaoyri1220.com/post-images/1709876862608.png" alt="" loading="lazy"></figure>
<h3 id="testing-multiple-coefficients">Testing multiple coefficients</h3>
<figure data-type="image" tabindex="15"><img src="https://hiakkaoyri1220.com/post-images/1709877492009.png" alt="" loading="lazy"></figure>
<h3 id="prediction-in-multiple-regression">Prediction in multiple regression</h3>
<figure data-type="image" tabindex="16"><img src="https://hiakkaoyri1220.com/post-images/1709877533711.png" alt="" loading="lazy"></figure>
<h3 id="a-1001-alpha-confidence-interval-for-eta_0-xt_0-beta">A <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>100</mn><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">100(1 - \alpha)%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span> confidence interval for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>η</mi><mn>0</mn></msub><mo>=</mo><msubsup><mi>x</mi><mn>0</mn><mi>T</mi></msubsup><mi>β</mi></mrow><annotation encoding="application/x-tex">\eta_0 = x^{T}_0 \beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0894389999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span></h3>
<figure data-type="image" tabindex="17"><img src="https://hiakkaoyri1220.com/post-images/1709877551435.png" alt="" loading="lazy"></figure>
<h3 id="a-1001-alpha-prediction-interval-for-y_0">A <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>100</mn><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">100(1 - \alpha)%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span> prediction interval for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">Y_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></h3>
<figure data-type="image" tabindex="18"><img src="https://hiakkaoyri1220.com/post-images/1709877986917.png" alt="" loading="lazy"></figure>
<h2 id="case-study">Case study</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1710426799768.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710427441572.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710427691642.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710427704372.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710468015574.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710468036734.png" alt="" loading="lazy"></p>
<h3 id="anova-test">anova test</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710468326350.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710468412215.png" alt="" loading="lazy"></p>
<h3 id="predict">Predict</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710468661537.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710468690778.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718155766379.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710483399366.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710483434082.png" alt="" loading="lazy"></p>
<h1 id="week3">Week3</h1>
<h2 id="factors-in-r">Factors in R</h2>
<h3 id="multiple-regression-models-in-r">Multiple regression models in R</h3>
<p>When we use a command of the form lm(y ~ x, data = df) where</p>
<ul>
<li>y is a vector containing the y-values and</li>
<li>x is a vector containing the x-values<br>
The argument y~ x is called the <strong>model formula</strong><br>
the term to the left of ~ is the response variables, while the stuff to the right of ~ is used to get the design matrix <em><strong>X</strong></em></li>
</ul>
<h3 id="multiple-predictors">Multiple predictors</h3>
<p>Multiple regression models can be specified by including additional terms in the right hand side of the model formula, separated by the + symbol.</p>
<h3 id="functions">Functions</h3>
<p>Functions can be applied directly to any terms in the model formula<br>
<img src="https://hiakkaoyri1220.com/post-images/1710740976223.png" alt="" loading="lazy"></p>
<h3 id="i-operator">I() operator</h3>
<p>Arithmetic calculations, involving addition, subtraction, multiplication, division can also be incorporated into the model formula but must be enclosed within the <em>I</em> (inhibit) function. The reason is that the operators +,-,*,/ and ^ have different interpretations in the context of a model formula</p>
<h3 id="factors">Factors</h3>
<p>A categorical presictor variable is called a <strong>factor</strong></p>
<h3 id="example">example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710741209262.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710741325087.png" alt="" loading="lazy"></p>
<h4 id="constraints">Constraints</h4>
<p>The additive formulation shown above cannot be used directly because the parameters <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>α</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>β</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> are not identifiable</p>
<ul>
<li>That is, if we tried to construct the model matrix <em>X</em>, the columns would not be linearly independent.</li>
<li>For this reason, it is necessarry to impose certain constraints on the parameters</li>
</ul>
<h5 id="approach-1-zero-sum">Approach 1: zero sum</h5>
<p>The classical approach is to impose the side conditions,</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>r</mi></munderover><msub><mi>α</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>s</mi></munderover><msub><mi>β</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^r\alpha_i =\sum_{j=1}^s\beta_j = 0  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<h5 id="approach-2-reference-level">Approach 2: reference level</h5>
<p>For most computing packages, the default parameterisation is to use the <strong>treatment constrasts</strong> defined by</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>α</mi><mn>1</mn></msub><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha_1 = \beta_1 = 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<h4 id="interpretation">Interpretation</h4>
<figure data-type="image" tabindex="19"><img src="https://hiakkaoyri1220.com/post-images/1710741818237.png" alt="" loading="lazy"></figure>
<h3 id="interactions">interactions</h3>
<figure data-type="image" tabindex="20"><img src="https://hiakkaoyri1220.com/post-images/1710741854264.png" alt="" loading="lazy"></figure>
<h3 id="r-example">R example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710741904894.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710741982784.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710742103582.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710742124532.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710742114001.png" alt="" loading="lazy"><br>
x1^2 without I() won't produce anything<br>
<img src="https://hiakkaoyri1220.com/post-images/1710742223842.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710742237805.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710742302736.png" alt="" loading="lazy"><br>
reference level delete first column that is alpha order, therefore level 1 disappear. Means if we have k column, we will end up will k-1 column.<br>
<img src="https://hiakkaoyri1220.com/post-images/1710742316895.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710742432070.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710742443517.png" alt="" loading="lazy"></p>
<h3 id="the-operator">The + operator</h3>
<figure data-type="image" tabindex="21"><img src="https://hiakkaoyri1220.com/post-images/1710917354547.png" alt="" loading="lazy"></figure>
<h3 id="the-operator-parallel-regression">The + operator - parallel regression</h3>
<figure data-type="image" tabindex="22"><img src="https://hiakkaoyri1220.com/post-images/1710917466521.png" alt="" loading="lazy"></figure>
<h3 id="the-operator-2">The : operator</h3>
<p>The interaction operator, :, is used to generate interactions between factors or between factors and covariates<br>
<img src="https://hiakkaoyri1220.com/post-images/1710917914304.png" alt="" loading="lazy"></p>
<h3 id="the-operator-seprate-regression">The : operator - seprate regression</h3>
<figure data-type="image" tabindex="23"><img src="https://hiakkaoyri1220.com/post-images/1710917972937.png" alt="" loading="lazy"></figure>
<h3 id="the-operator-3">The * operator</h3>
<figure data-type="image" tabindex="24"><img src="https://hiakkaoyri1220.com/post-images/1710941874676.png" alt="" loading="lazy"></figure>
<h3 id="the-operator-4">The ^ operator</h3>
<figure data-type="image" tabindex="25"><img src="https://hiakkaoyri1220.com/post-images/1710941912134.png" alt="" loading="lazy"></figure>
<h3 id="the-operator-5">The - operator</h3>
<figure data-type="image" tabindex="26"><img src="https://hiakkaoyri1220.com/post-images/1710941997781.png" alt="" loading="lazy"></figure>
<h3 id="the-operator-6">The / operator</h3>
<figure data-type="image" tabindex="27"><img src="https://hiakkaoyri1220.com/post-images/1710942062650.png" alt="" loading="lazy"></figure>
<h3 id="example-2">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1710942104906.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942114643.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942266157.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942289259.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942276854.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942464816.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942455838.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942514139.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942550508.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942573381.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1710942690100.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718608340163.png" alt="" loading="lazy"><br>
if it's symbol /, then the slope of Adog is directly the value 0.8,<br>
if it's symbol is *, the we have to the get the slope of <em>x</em> first, the plus the slope of Adog based on <em>x</em>, that is 0.12 + 0.68 = 0.80<br>
<img src="https://hiakkaoyri1220.com/post-images/1710942701636.png" alt="" loading="lazy"></p>
<h2 id="poison-example">Poison example</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1711076808848.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711077246467.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711077256255.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711077639378.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711077649263.png" alt="" loading="lazy"><br>
the difference between each group compare to the reference level group,<br>
the intercept is the group mean of the reference level group<br>
<img src="https://hiakkaoyri1220.com/post-images/1711077657760.png" alt="" loading="lazy"></p>
<h3 id="different-design-matrix">Different design matrix</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1711077956792.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711077972807.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711077998582.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718297557004.png" alt="" loading="lazy"><br>
contr is zero sum -&gt; represent average mean</p>
<p><img src="https://hiakkaoyri1220.com/post-images/1711078492493.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1711078501324.png" alt="" loading="lazy"><br>
pick -1</p>
<h1 id="week4">Week4</h1>
<h2 id="marginality">Marginality</h2>
<h3 id="the-marginality-principle">The marginality principle</h3>
<p>Whenever an interaction term is included in the model, all implied lower order interactions and main effects must also be included.</p>
<h4 id="example-3">Example</h4>
<p>Suppose the interaction term A:B:C is to be included in a model, The marginality principle requires that all of the following model terms must also be included.</p>
<ul>
<li>the two-way interaction terms, A:B, A:C, B:C,</li>
<li>the main effects A,B,C,</li>
<li>and the intercept 1.</li>
</ul>
<h4 id="why-need-marginality-principle">Why need marginality principle?</h4>
<ul>
<li>It is necessary to impose constraints on the parameters of the model to achieve identifiability;</li>
<li>The constraints will not affect the model provided that the marginality principle is observed.</li>
</ul>
<h4 id="the-marginality-principle-in-r">The marginality principle in R</h4>
<figure data-type="image" tabindex="28"><img src="https://hiakkaoyri1220.com/post-images/1712298653540.png" alt="" loading="lazy"></figure>
<h5 id="example-4">Example</h5>
<p>If the A main effect is removed(in violation of the marginality principle) R compenstates by removing the constraint <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>γ</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma_{i1} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span><br>
If the interaction term A:B is specified in isolation, i.e. without the necessary main effects, R tries to compensate by removing all constraints on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\gamma_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>.<br>
Note the columns of the resulting model matrix are not <em><strong>linearly independent</strong></em></p>
<h3 id="models-with-factors-and-covariates">Models with factors and covariates</h3>
<figure data-type="image" tabindex="29"><img src="https://hiakkaoyri1220.com/post-images/1712299263650.png" alt="" loading="lazy"></figure>
<h3 id="polynomial-regressions">Polynomial regressions</h3>
<figure data-type="image" tabindex="30"><img src="https://hiakkaoyri1220.com/post-images/1712300039385.png" alt="" loading="lazy"></figure>
<h3 id="example-5">example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718381557058.png" alt="" loading="lazy"><br>
remove intercept<br>
<img src="https://hiakkaoyri1220.com/post-images/1712300271378.png" alt="" loading="lazy"></p>
<h2 id="assumption-checking">Assumption Checking</h2>
<h3 id="why-assumption-checking">Why assumption checking</h3>
<p>An important part of good statistical practice is assumption checking.<br>
When a model is applied to data, it is important to understand that the use of the model involves making certain assumptions about the data.<br>
If the assumptions are not valid, then conclusions based on the model have the potential to be misleading.<br>
It is therefore important to check the assumptions as far as possible before using a statistical model to make conclusions.</p>
<h3 id="regression-assumptions">Regression Assumptions</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712386406376.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712386496206.png" alt="" loading="lazy"><br>
In practice, most attention is focused on using the data to investigate the plausibility of assumptions 1-3.<br>
Assumptions 4-6 are more fundamental but cannot be verified from the observed data.<br>
It is important to understand the context in which the data arose in order to determine whether these assumptions are reasonable.</p>
<h3 id="residuals">Residuals</h3>
<p>the left over value between observe value minus the fitted value (actual value minus the predict value)<br>
<img src="https://hiakkaoyri1220.com/post-images/1712386785011.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712386842183.png" alt="" loading="lazy"></p>
<h3 id="distribution-of-residuals">Distribution of Residuals</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712386879872.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712386956589.png" alt="" loading="lazy"></p>
<h3 id="example-6">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718382523913.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718382549641.png" alt="" loading="lazy"></p>
<h3 id="standardized-residuals">Standardized Residuals</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712466581103.png" alt="" loading="lazy"><br>
A second difficulty with the raw and standardized residuals:</p>
<ul>
<li>an aberrant <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo></mrow><annotation encoding="application/x-tex">y_i-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span></span></span></span>value may influence the corresponding fitted value, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>η</mi><mi>i</mi></msub><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\eta_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></li>
<li>this may lead to an unremarkable residual,</li>
<li>thus masking the fact that the data point was in fact aberrant</li>
</ul>
<h3 id="studentized-residuals">Studentized Residuals</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712466850236.png" alt="" loading="lazy"><br>
The relationship between standardized and studentized<br>
<img src="https://hiakkaoyri1220.com/post-images/1712466879576.png" alt="" loading="lazy"></p>
<h3 id="model-checking-with-residuals">Model checking with residuals</h3>
<p>It is recommended that the studentized residuals be used for basic model checking as introduced in previous courses.</p>
<ul>
<li>The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msubsup><mi>e</mi><mi>i</mi><mo>∗</mo></msubsup><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{e_{i}^*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2107999999999999em;vertical-align:-0.27686399999999994em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9339359999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.670496em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.239496em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span> should be plotted against the fitted values to check for lack of fit and heteroscedasticity.</li>
<li>the  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msubsup><mi>e</mi><mi>i</mi><mo>∗</mo></msubsup><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{e_{i}^*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2107999999999999em;vertical-align:-0.27686399999999994em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9339359999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.670496em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.239496em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span> should be plotted against each of the predictor variables separately to check for lack of fit and heteroscedasticity.</li>
<li>If an additional variable such as &quot;time&quot; is recorded but not considered for inclusion in the model, it is good practice to plot the residuals against time to check for any trends etc.</li>
<li>if there are no problems with lack of fit, heteroscedasticity and trends over time( when applicable), a normal quantile plot of the residuals can be used to assess the assumpiton of normality.</li>
</ul>
<h2 id="influence-diagnostics">influence diagnostics</h2>
<ul>
<li>It sometimes happens that a data set contains a small number of outliers or points with large residuals.</li>
<li>The occurrence of such points can be problemmatic in the sense that a single outlier may have a appreciable impact on the parameter estimates.</li>
<li>If it cannot be verified that the data point is erroneous then there is no good basis for its omission although one may nevertheless be suspicious.</li>
<li>Influence diagnostics are used to help identify points that have a disproportionately large impact on the estimates.</li>
</ul>
<h3 id="influence">Influence</h3>
<ul>
<li>In general, a point with a small studentized residual is unlikely to have a large impact on the parameter estimates.</li>
<li>A point with a large studentized residual, may or may not depending on its <strong>leverage</strong></li>
</ul>
<h3 id="large-residual-high-leverage-high-influence">Large residual, high leverage, high influence</h3>
<figure data-type="image" tabindex="31"><img src="https://hiakkaoyri1220.com/post-images/1712472286348.png" alt="" loading="lazy"></figure>
<h3 id="large-residual-low-leverage-low-influence">Large residual, low leverage, low influence</h3>
<figure data-type="image" tabindex="32"><img src="https://hiakkaoyri1220.com/post-images/1712472355642.png" alt="" loading="lazy"></figure>
<h3 id="small-residual-high-leverage-low-influence">Small residual, high leverage, low influence</h3>
<figure data-type="image" tabindex="33"><img src="https://hiakkaoyri1220.com/post-images/1712472434973.png" alt="" loading="lazy"></figure>
<h3 id="small-residual-low-leverage-low-influence">Small residual, low leverage, low influence</h3>
<figure data-type="image" tabindex="34"><img src="https://hiakkaoyri1220.com/post-images/1712472481959.png" alt="" loading="lazy"></figure>
<h3 id="influence-and-leverage">Influence and leverage</h3>
<p><strong>leverage is the concept of In any particular point, how far away from all the other point</strong>.<br>
In each case, the blue line represents the least squares regression line when all points are included and the red line is the least square regression line with the marked point excluded.<br>
In simple linear gression, the notion of <strong>leverage</strong> can be thought of as a metric for the distance from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.56778em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">ˉ</span></span></span></span></span></span></span></span></span><br>
In the frist plot, where  the marked point has a large residual and of high leverage, the slope is changed appreciably. In the remaining plots, the omission of the marked point has only minimal impact on the least squares regression line.</p>
<h3 id="leverage-of-data-point">leverage of data point</h3>
<figure data-type="image" tabindex="35"><img src="https://hiakkaoyri1220.com/post-images/1712472788790.png" alt="" loading="lazy"></figure>
<h3 id="leverage-of-linear-regression">leverage of linear regression</h3>
<figure data-type="image" tabindex="36"><img src="https://hiakkaoyri1220.com/post-images/1712472841749.png" alt="" loading="lazy"></figure>
<h3 id="average-value-of-leverage">average value of leverage</h3>
<figure data-type="image" tabindex="37"><img src="https://hiakkaoyri1220.com/post-images/1712472918542.png" alt="" loading="lazy"></figure>
<h3 id="leverage-info">leverage info</h3>
<ul>
<li>Leverages are sometimes displayed using an index plot.</li>
<li>That is, a plot of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{ii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> vs i, to identify points of high leverage.</li>
<li>Some authors suggest that points with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mi>i</mi><mo>≥</mo><mn>2</mn><mi>p</mi><mi mathvariant="normal">/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">h_ii \ge 2p/n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathdefault">p</span><span class="mord">/</span><span class="mord mathdefault">n</span></span></span></span> be highlighted</li>
<li>Shown on the following slide( for the data from the large residual/high leverage scatter plot) is
<ul>
<li>the histogram of x-values , and</li>
<li>a leverage plot.</li>
</ul>
</li>
</ul>
<h3 id="leverage-example">leverage example</h3>
<figure data-type="image" tabindex="38"><img src="https://hiakkaoyri1220.com/post-images/1712473177454.png" alt="" loading="lazy"></figure>
<h3 id="cooks-distanceuse-to-measure-influence">Cook's Distance(use to measure influence)</h3>
<ul>
<li>Points of high leverage have potentially a large impact on the estimates<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>β</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523199999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></li>
<li>Cook's distance measures how much influence each data point actually has by calculating the effect of its removal upon <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>β</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523199999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></li>
<li><img src="https://hiakkaoyri1220.com/post-images/1712473339900.png" alt="" loading="lazy"></li>
<li><img src="https://hiakkaoyri1220.com/post-images/1712473379781.png" alt="" loading="lazy"></li>
<li><img src="https://hiakkaoyri1220.com/post-images/1712473402605.png" alt="" loading="lazy"></li>
</ul>
<h4 id="plotting-cooks-distance">Plotting Cook's distance</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712473428577.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712473530875.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712473513036.png" alt="" loading="lazy"></p>
<h2 id="case-study-cheese">Case study - Cheese</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1712474257614.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712474271271.png" alt="" loading="lazy"><br>
get residuals and studentized residuals<br>
<img src="https://hiakkaoyri1220.com/post-images/1712552512847.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712552714037.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718523181145.png" alt="" loading="lazy"><br>
standardised and studentized residuals vs residuals should be roughly the same, if not, that means we have a influence point</p>
<h1 id="week5">Week5</h1>
<h2 id="gls">GLS</h2>
<h3 id="generalised-least-squares">Generalised least squares</h3>
<figure data-type="image" tabindex="42"><img src="https://hiakkaoyri1220.com/post-images/1712556754126.png" alt="" loading="lazy"></figure>
<h4 id="symmetry">Symmetry</h4>
<figure data-type="image" tabindex="43"><img src="https://hiakkaoyri1220.com/post-images/1712556772427.png" alt="" loading="lazy"></figure>
<h4 id="positive-definite">Positive definite</h4>
<figure data-type="image" tabindex="44"><img src="https://hiakkaoyri1220.com/post-images/1712556805910.png" alt="" loading="lazy"></figure>
<h4 id="variance-matrices-are-non-negative-definite">Variance matrices are non-negative definite</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712556850607.png" alt="" loading="lazy"><br>
If <em>V</em> is non-negative definite but not positive definite, then there must exist <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi mathvariant="normal">≠</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">a \ne 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> for which</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mo>(</mo><msup><mi>a</mi><mi>T</mi></msup><mi>Y</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">var(a^TY) = 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>In this case, one of the observations is a linear function of the others.<br>
To eliminate any such redundancy, we assume that V is positive definite</p>
<h3 id="ordinary-least-squares">Ordinary least squares</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712561198987.png" alt="" loading="lazy"><br>
OLS not optimal</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>β</mi><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow></msub><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\beta_{OLS}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523199999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span> is an unbiased linear estimator that we can easily compute</li>
<li>But the assumptions of the Gauss-Markov theorem do not hold.</li>
<li>it is therefore not the <strong>best</strong> linear unbiased estimator</li>
</ul>
<h3 id="squaer-root-matrices">Squaer-root matrices</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712561528909.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712561645727.png" alt="" loading="lazy"></p>
<h3 id="generalised-least-squares-2">Generalised least squares</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718530595720.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712563279596.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712563300714.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712563458795.png" alt="" loading="lazy"></p>
<h3 id="weighted-least-squares">Weighted least squares</h3>
<figure data-type="image" tabindex="45"><img src="https://hiakkaoyri1220.com/post-images/1712563501587.png" alt="" loading="lazy"></figure>
<h4 id="example-7">Example</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712563522204.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712563593926.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712563603026.png" alt="" loading="lazy"><br>
Intuitively, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>μ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\mu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">μ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span> gives greater weight to observations with lower variance, compared to the OLS estimator <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Y</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span> which weights all observations equally.<br>
It can also be proved from first principles to be the best linear unbiased estimator for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span></p>
<h2 id="box-cox">Box-Cox</h2>
<h3 id="transformations">Transformations</h3>
<p>When the assumptions of linearity, homoscedasticity and normality are found to be violated, it is sometimes possible to find a simple transformation of the data for which the regression assumptions are more reasonable.<br>
For example, transformations such as log <em>y</em>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msqrt><mi>y</mi></msqrt><mo separator="true">,</mo><mfrac><mn>1</mn><mi>y</mi></mfrac></mrow><annotation encoding="application/x-tex">\sqrt{y},\frac{1}{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.70306em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.66306em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.33693999999999996em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> when dealing with a positive variable <em>Y</em><br>
A simple approach is to consider each of these transformations and chose the one for which the model diagnostics(residuals) appear most reasonable.</p>
<h3 id="the-box-cox-transformations">The Box-Cox transformations</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712564447016.png" alt="" loading="lazy"><br>
by L'Hôpital's rule<br>
<img src="https://hiakkaoyri1220.com/post-images/1718531691466.png" alt="" loading="lazy"></p>
<h3 id="overview">Overview</h3>
<p>The Box-Cox approach to transformation consists of the following steps.</p>
<ul>
<li>In the first instance, treat <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> as an unknown parameter and obtain an estimate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>λ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9578799999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span></span></span></span> from the data;</li>
<li>Perform the usual regression diagnostics on the transformed data.
<ul>
<li>If they are satisfactory, adopt <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>λ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9578799999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span></span></span></span></li>
<li>if they are not satisfactory, conclude that no suitable transformationis available.</li>
</ul>
</li>
<li>When a transformation is adopted, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>λ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9578799999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span></span></span></span> is treated as a known constant and analysis of the transformed data proceeds in the usual way.</li>
</ul>
<h3 id="the-profile-likelihood">The profile likelihood</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712580512871.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712581149807.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712581175323.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712581604881.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712581675580.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712581742791.png" alt="" loading="lazy"></p>
<h3 id="case-studyexample-of-box-cox">Case study(example of  box-cox)</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712582581685.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712582659897.png" alt="" loading="lazy"><br>
have problem with heteroscedasticity</p>
<h4 id="box-cox-2">Box-Cox</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712582754766.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712582786236.png" alt="" loading="lazy"><br>
three lines, the middle one is maximum likelihood, the value we should use, other two are the 95% confidence interval</p>
<h4 id="change-to-log">Change to log</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1712582861512.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712582895256.png" alt="" loading="lazy"></p>
<h1 id="week6">Week6</h1>
<h2 id="lrlogistic-regression">LR(logistic regression)</h2>
<figure data-type="image" tabindex="46"><img src="https://hiakkaoyri1220.com/post-images/1712636580428.png" alt="" loading="lazy"></figure>
<h3 id="the-binomial-model">THe binomial model</h3>
<figure data-type="image" tabindex="47"><img src="https://hiakkaoyri1220.com/post-images/1712636676879.png" alt="" loading="lazy"></figure>
<h3 id="linear-model-for-the-probability">Linear model for the probability</h3>
<figure data-type="image" tabindex="48"><img src="https://hiakkaoyri1220.com/post-images/1712636722256.png" alt="" loading="lazy"></figure>
<h3 id="the-logistic-regression-model">The logistic regression model</h3>
<figure data-type="image" tabindex="49"><img src="https://hiakkaoyri1220.com/post-images/1712636772579.png" alt="" loading="lazy"></figure>
<h3 id="properties-of-the-logit-transformation">Properties of the logit transformation</h3>
<figure data-type="image" tabindex="50"><img src="https://hiakkaoyri1220.com/post-images/1712636869770.png" alt="" loading="lazy"></figure>
<h3 id="the-logistic-curve">The logistic curve</h3>
<figure data-type="image" tabindex="51"><img src="https://hiakkaoyri1220.com/post-images/1712636927724.png" alt="" loading="lazy"></figure>
<h3 id="bettle-example">Bettle example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712637171416.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712637161209.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714719439001.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1712637217700.png" alt="" loading="lazy"></p>
<h3 id="no-additive-error">No additive error</h3>
<figure data-type="image" tabindex="52"><img src="https://hiakkaoyri1220.com/post-images/1712637288589.png" alt="" loading="lazy"></figure>
<h3 id="bettle-case-study">Bettle case study</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1712637493910.png" alt="" loading="lazy"><br>
by changing parameter in geom_smooth(), we can create a logistic regression line<br>
<img src="https://hiakkaoyri1220.com/post-images/1712637504508.png" alt="" loading="lazy"><br>
building  up <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> matrix as the response variable, let family = binomial to mapping the matrix as success and failure, using logit.<br>
<img src="https://hiakkaoyri1220.com/post-images/1712637683416.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718559494653.png" alt="" loading="lazy"></p>
<h1 id="week-7">Week 7</h1>
<h2 id="mle">MLE</h2>
<h3 id="estimation">Estimation</h3>
<figure data-type="image" tabindex="53"><img src="https://hiakkaoyri1220.com/post-images/1713767158594.png" alt="" loading="lazy"></figure>
<h3 id="maximum-likelihood-for-vector-form">Maximum likelihood for vector form</h3>
<figure data-type="image" tabindex="54"><img src="https://hiakkaoyri1220.com/post-images/1713767383041.png" alt="" loading="lazy"></figure>
<h3 id="the-log-likelihood-function">The log-likelihood function</h3>
<figure data-type="image" tabindex="55"><img src="https://hiakkaoyri1220.com/post-images/1713767378180.png" alt="" loading="lazy"></figure>
<h4 id="the-maximum-likelihodo-equations">The maximum likelihodo equations</h4>
<p>To fidn the maximum likelihood estimates, we need to solve the equations</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="normal">ℓ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>β</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \frac{\partial \ell}{\partial \beta_j} =0 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-0.972108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">j = 1,2,\dots,p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span></span></span></span><br>
<img src="https://hiakkaoyri1220.com/post-images/1713767931423.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713768119546.png" alt="" loading="lazy"></p>
<h3 id="the-information-matrix">The information matrix</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1713768202024.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713768292994.png" alt="" loading="lazy"></p>
<h3 id="newton-raphson-algorithm">Newton-Raphson algorithm</h3>
<figure data-type="image" tabindex="56"><img src="https://hiakkaoyri1220.com/post-images/1713768514147.png" alt="" loading="lazy"></figure>
<h3 id="fisher-scoring">Fisher Scoring</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1713768603890.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713768674285.png" alt="" loading="lazy"></p>
<h3 id="initial-value">Initial value</h3>
<figure data-type="image" tabindex="57"><img src="https://hiakkaoyri1220.com/post-images/1713768701412.png" alt="" loading="lazy"></figure>
<h2 id="inference">Inference</h2>
<h3 id="inference-for-regression-coefficients">Inference for regression coefficients</h3>
<figure data-type="image" tabindex="58"><img src="https://hiakkaoyri1220.com/post-images/1713769159471.png" alt="" loading="lazy"></figure>
<h3 id="confidence-interval">Confidence interval</h3>
<figure data-type="image" tabindex="59"><img src="https://hiakkaoyri1220.com/post-images/1713769211785.png" alt="" loading="lazy"></figure>
<h3 id="hypotheses-concerning-several-parameters">Hypotheses concerning several parameters</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1713769431532.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713769479721.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713769493791.png" alt="" loading="lazy"></p>
<h3 id="deviance-statistic">Deviance statistic</h3>
<figure data-type="image" tabindex="60"><img src="https://hiakkaoyri1220.com/post-images/1713769522366.png" alt="" loading="lazy"></figure>
<h3 id="model-fit">Model fit</h3>
<p>As with any statistical analysis we need to check the model assumptions.<br>
In this case, there are two approaches that can be used.</p>
<ul>
<li>A formal approach: hypothesis testing.</li>
<li>An less formal approach: observe residuals from the model fit.</li>
</ul>
<h4 id="formal-approach">Formal approach</h4>
<p>the likelihood ratio test statistic against the saturated model can be obtained as the residual deviance. It fcan also obtained using <code>anova()</code> function to compare the glm object against model. When compare, it is essential that one of the models is a sub-model of the other.</p>
<h4 id="less-formal-approach">Less formal approach</h4>
<p>Plot residual from the model fit.</p>
<h3 id="pearson-residual">pearson residual</h3>
<figure data-type="image" tabindex="61"><img src="https://hiakkaoyri1220.com/post-images/1713770139303.png" alt="" loading="lazy"></figure>
<h3 id="deviance-residual">deviance residual</h3>
<figure data-type="image" tabindex="62"><img src="https://hiakkaoyri1220.com/post-images/1713770165815.png" alt="" loading="lazy"></figure>
<h3 id="residual">residual</h3>
<p>Both types of residuals can use as residuals from ordinary linera regression. Take care that they <em><strong>are not standardized</strong></em></p>
<h3 id="non-grouped-data-residuals">Non-grouped data residuals</h3>
<figure data-type="image" tabindex="63"><img src="https://hiakkaoyri1220.com/post-images/1713770315967.png" alt="" loading="lazy"></figure>
<h3 id="over-dispersion">Over-dispersion</h3>
<figure data-type="image" tabindex="64"><img src="https://hiakkaoyri1220.com/post-images/1713770377935.png" alt="" loading="lazy"></figure>
<h4 id="case-study-2">Case study</h4>
<figure data-type="image" tabindex="65"><img src="https://hiakkaoyri1220.com/post-images/1713775616674.png" alt="" loading="lazy"></figure>
<h3 id="existence-of-mle">Existence of MLE</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1713770550059.png" alt="" loading="lazy"><br>
the data too good, not convergence well<br>
<img src="https://hiakkaoyri1220.com/post-images/1713770585767.png" alt="" loading="lazy"></p>
<h3 id="warning-signs-for-logistic-regression">Warning signs for logistic regression</h3>
<p>When using the logistic regression, it is good practice to check for convergence. In particular,</p>
<ul>
<li>warning messages</li>
<li>High number of iterations</li>
<li>Some parameter estimates and standard errors with very large numerical values.</li>
<li>Estimated probabilities very close to zero or one.</li>
</ul>
<h2 id="case-study-beetle">Case study beetle</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1713773481798.png" alt="" loading="lazy"><br>
std.error is the invert fisher information diganotics<br>
<img src="https://hiakkaoyri1220.com/post-images/1713773486822.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718627026592.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718627038072.png" alt="" loading="lazy"><br>
A saturated model is a model that is overparameterized to the point that it is basically just interpolating the data.<br>
<img src="https://hiakkaoyri1220.com/post-images/1713773592024.png" alt="" loading="lazy"><br>
This means the residual deviance is at 0.02 level, so it is significant<br>
<img src="https://hiakkaoyri1220.com/post-images/1713773838672.png" alt="" loading="lazy"><br>
can still improve since it is very small<br>
<img src="https://hiakkaoyri1220.com/post-images/1713773944388.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713773966070.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713774033058.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713774144727.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713774154091.png" alt="" loading="lazy"></p>
<h2 id="cells-example">Cells example</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718627570048.png" alt="" loading="lazy"><br>
over-dispersion</p>
<h2 id="fisher-score-implement-in-r">Fisher score implement in R</h2>
<figure data-type="image" tabindex="66"><img src="https://hiakkaoyri1220.com/post-images/1713775816357.png" alt="" loading="lazy"></figure>
<h3 id="find-x">Find X</h3>
<figure data-type="image" tabindex="67"><img src="https://hiakkaoyri1220.com/post-images/1713775889608.png" alt="" loading="lazy"></figure>
<h3 id="find-beta0">Find <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>β</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">\beta^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1713775963186.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713775975517.png" alt="" loading="lazy"></p>
<h3 id="find-betat1-text-given-betat">Find <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>β</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext> given </mtext><msup><mi>β</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\beta^{t+1} \text{ given } \beta^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord text"><span class="mord"> given </span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span></h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1713776041234.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713776065482.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713776100793.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1713776128136.png" alt="" loading="lazy"></p>
<h1 id="week-8">Week 8</h1>
<h2 id="stratification">Stratification</h2>
<h3 id="common-odds-ratios-for-several-2-times-2-tables">Common odds ratios for several  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> tables</h3>
<p>Sometimes it happens that an experiment or observational study is replicated across many strata</p>
<h3 id="example-for-uc_berkeley-data-set">Example for UC_Berkeley data set</h3>
<ul>
<li>Observational study</li>
<li>Applications for admission to graduate study</li>
<li>Classified according to
<ul>
<li>whether the applicant was admitted;</li>
<li>the sex of the applicant;</li>
<li>the department applied to<br>
<img src="https://hiakkaoyri1220.com/post-images/1714451676078.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714451701860.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714451759317.png" alt="" loading="lazy"></li>
</ul>
</li>
</ul>
<h3 id="odds-ratios">Odds ratios</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714451887344.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714451899787.png" alt="" loading="lazy"></p>
<h3 id="the-common-odds-ratio-model">The common odds ratio model</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714452370944.png" alt="" loading="lazy"><br>
In the analysis, the(common) log odds-ratio is estimated to be -0.09987 with a standard error of 0.08085.<br>
This is not significantly different from 0 which implies no strong evidence of discrimination within department in either direction</p>
<h4 id="simpsons-paradox">Simpson's Paradox</h4>
<figure data-type="image" tabindex="68"><img src="https://hiakkaoyri1220.com/post-images/1714452575968.png" alt="" loading="lazy"></figure>
<h3 id="proportion-plot">Proportion plot</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714452674621.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714452686832.png" alt="" loading="lazy"></p>
<h3 id="prospective-and-retrospective-studies">Prospective and retrospective studies</h3>
<figure data-type="image" tabindex="69"><img src="https://hiakkaoyri1220.com/post-images/1714453305686.png" alt="" loading="lazy"></figure>
<h3 id="retrospective-studies">Retrospective studies</h3>
<figure data-type="image" tabindex="70"><img src="https://hiakkaoyri1220.com/post-images/1714453392100.png" alt="" loading="lazy"></figure>
<h3 id="analysis-for-retrospective-studies">Analysis for retrospective studies</h3>
<p>The retrospective studies require a very different analysis to ordinary prospective studies.<br>
While this is generally the case, for certain retrospective studies, the logistic regression model can be validly applied as if it were a prospective study.</p>
<h3 id="logistic-regression-and-retrospective-studies">Logistic regression and retrospective studies</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1714453524692.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714453920471.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714453965323.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714501721986.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714454040629.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1714454056060.png" alt="" loading="lazy"></p>
<h3 id="example-8">Example</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718668573386.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718668590581.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718668757586.png" alt="" loading="lazy"></p>
<h2 id="generalised-linear-models-summary">Generalised linear models summary</h2>
<figure data-type="image" tabindex="71"><img src="https://hiakkaoyri1220.com/post-images/1716017042511.png" alt="" loading="lazy"></figure>
<h2 id="week-9">Week 9</h2>
<h3 id="poisson-regression">Poisson regression</h3>
<h4 id="poisson-data">Poisson data</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1716016572617.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1716016785998.png" alt="" loading="lazy"></p>
<h4 id="poisson-regression-models">Poisson Regression models</h4>
<figure data-type="image" tabindex="72"><img src="https://hiakkaoyri1220.com/post-images/1716016856929.png" alt="" loading="lazy"></figure>
<h4 id="log-linera-models">Log-linera Models</h4>
<figure data-type="image" tabindex="73"><img src="https://hiakkaoyri1220.com/post-images/1716016992346.png" alt="" loading="lazy"></figure>
<h4 id="fitting-in-r">Fitting in r</h4>
<figure data-type="image" tabindex="74"><img src="https://hiakkaoyri1220.com/post-images/1716017123435.png" alt="" loading="lazy"></figure>
<h4 id="interpretation-of-coefficients">Interpretation of coefficients</h4>
<figure data-type="image" tabindex="75"><img src="https://hiakkaoyri1220.com/post-images/1716017218251.png" alt="" loading="lazy"></figure>
<h5 id="example-9">Example</h5>
<figure data-type="image" tabindex="76"><img src="https://hiakkaoyri1220.com/post-images/1716017305486.png" alt="" loading="lazy"></figure>
<h3 id="poisson-rate-regression">Poisson rate regression</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1716017365290.png" alt="" loading="lazy"><br>
log(offset) always equal to 1<br>
<img src="https://hiakkaoyri1220.com/post-images/1716017504337.png" alt="" loading="lazy"></p>
<h3 id="case-study-roadkill-poisson-regression">Case study- Roadkill (poisson regression)</h3>
<figure data-type="image" tabindex="77"><img src="https://hiakkaoyri1220.com/post-images/1716018061557.png" alt="" loading="lazy"></figure>
<h4 id="update-model">Update model</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1716018082226.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718673356735.png" alt="" loading="lazy"><br>
pattern exist<br>
<img src="https://hiakkaoyri1220.com/post-images/1718673397187.png" alt="" loading="lazy"><br>
predict will give you log(y_i), if we want the y_i, we can set type = response</p>
<h3 id="poisson-rate-regression-case-study">Poisson rate regression case study</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718673636752.png" alt="" loading="lazy"><br>
log offset force to be 1<br>
<img src="https://hiakkaoyri1220.com/post-images/1718673767271.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718673779432.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718673794688.png" alt="" loading="lazy"></p>
<h1 id="week-10">Week 10</h1>
<h2 id="leprosy-example">Leprosy example</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718717724536.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718717738922.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718717764062.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718717819451.png" alt="" loading="lazy"><br>
since it should be randomrised, we clearly see control has large group mean than other two<br>
<img src="https://hiakkaoyri1220.com/post-images/1718717906721.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718717939471.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718717951937.png" alt="" loading="lazy"><br>
before do the experiment, remember to put Covariate to check its effect</p>
<h2 id="fev">FEV</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1718719105780.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719115582.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719204987.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719234929.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719246469.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719281643.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719326092.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719337451.png" alt="" loading="lazy"><br>
call marginal prediction<br>
<img src="https://hiakkaoyri1220.com/post-images/1718719350558.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718719410369.png" alt="" loading="lazy"></p>
<h1 id="week-11">Week 11</h1>
<h2 id="model-selection">Model selection</h2>
<h3 id="model-selection-2">Model selection</h3>
<figure data-type="image" tabindex="78"><img src="https://hiakkaoyri1220.com/post-images/1718724069016.png" alt="" loading="lazy"></figure>
<h4 id="the-forward-selection-algorithm-with-p-values">The forward selection algorithm with P-values</h4>
<figure data-type="image" tabindex="79"><img src="https://hiakkaoyri1220.com/post-images/1718724295241.png" alt="" loading="lazy"></figure>
<h4 id="the-backwards-elimination-algorithm-with-p-values">The backwards elimination algorithm with P-values</h4>
<figure data-type="image" tabindex="80"><img src="https://hiakkaoyri1220.com/post-images/1718724696564.png" alt="" loading="lazy"></figure>
<h4 id="the-stepwise-selection-procedure-with-p-values">The stepwise selection procedure with P-values</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718724799588.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718724869072.png" alt="" loading="lazy"></p>
<h4 id="principle-of-marginality">Principle of marginality</h4>
<p>Whenever an interaction term is included in the model, all implied lower order interactions and main effects must also be included.<br>
For example if we find that we have an interaction ter, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_{i1}x_{i2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in the model, then we must keep the main effect <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_{i1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_{i2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in the model</p>
<h3 id="measures">Measures</h3>
<h4 id="root-mean-square-errorrmse">Root mean square error(RMSE)</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718725135511.png" alt="" loading="lazy"><br>
observed value minus the fitted value,smaller the better</p>
<h4 id="r-squared">R-squared</h4>
<figure data-type="image" tabindex="81"><img src="https://hiakkaoyri1220.com/post-images/1718725216613.png" alt="" loading="lazy"></figure>
<h4 id="mean-absolute-errormae">Mean absolute error(MAE)</h4>
<figure data-type="image" tabindex="82"><img src="https://hiakkaoyri1220.com/post-images/1718725238186.png" alt="" loading="lazy"></figure>
<h4 id="adjusted-r2">Adjusted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718725262989.png" alt="" loading="lazy"><br>
close to one, the better</p>
<h4 id="c_p"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">C_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></h4>
<figure data-type="image" tabindex="83"><img src="https://hiakkaoyri1220.com/post-images/1718725314112.png" alt="" loading="lazy"></figure>
<h4 id="residuals-summar-squared">Residuals summar squared</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718725361174.png" alt="" loading="lazy"><br>
observed value minus the fitted value</p>
<h4 id="mallows-c_p">Mallow's <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">C_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></h4>
<figure data-type="image" tabindex="84"><img src="https://hiakkaoyri1220.com/post-images/1718725444454.png" alt="" loading="lazy"></figure>
<h4 id="aic">AIC</h4>
<figure data-type="image" tabindex="85"><img src="https://hiakkaoyri1220.com/post-images/1718725455976.png" alt="" loading="lazy"></figure>
<h4 id="akaike-information-criterion-corrected-aicc">Akaike information criterion corrected (AICc)</h4>
<figure data-type="image" tabindex="86"><img src="https://hiakkaoyri1220.com/post-images/1718725520745.png" alt="" loading="lazy"></figure>
<h4 id="bic">BIC</h4>
<figure data-type="image" tabindex="87"><img src="https://hiakkaoyri1220.com/post-images/1718725531919.png" alt="" loading="lazy"></figure>
<h3 id="cross-validation">Cross validation</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718725628715.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718725643597.png" alt="" loading="lazy"></p>
<h4 id="notation-2">Notation</h4>
<figure data-type="image" tabindex="88"><img src="https://hiakkaoyri1220.com/post-images/1718725658413.png" alt="" loading="lazy"></figure>
<h4 id="prediction-error">Prediction error</h4>
<figure data-type="image" tabindex="89"><img src="https://hiakkaoyri1220.com/post-images/1718725674822.png" alt="" loading="lazy"></figure>
<h3 id="ridge-regression">Ridge regression</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718726004229.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718726018402.png" alt="" loading="lazy"></p>
<h4 id="the-complexity-parameter-lambda">The complexity parameter <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span></h4>
<figure data-type="image" tabindex="90"><img src="https://hiakkaoyri1220.com/post-images/1718726083995.png" alt="" loading="lazy"></figure>
<h4 id="dealing-with-the-intercept-term">Dealing with the intercept term</h4>
<figure data-type="image" tabindex="91"><img src="https://hiakkaoyri1220.com/post-images/1718726115831.png" alt="" loading="lazy"></figure>
<h4 id="ridge-regression-for-centred-data">Ridge regression for centred data</h4>
<figure data-type="image" tabindex="92"><img src="https://hiakkaoyri1220.com/post-images/1718726194088.png" alt="" loading="lazy"></figure>
<h4 id="scaling">Scaling</h4>
<figure data-type="image" tabindex="93"><img src="https://hiakkaoyri1220.com/post-images/1718726224717.png" alt="" loading="lazy"></figure>
<h4 id="model-complexity">Model complexity</h4>
<figure data-type="image" tabindex="94"><img src="https://hiakkaoyri1220.com/post-images/1718726239065.png" alt="" loading="lazy"></figure>
<h3 id="mpg-case-study">Mpg case study</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718726972365.png" alt="" loading="lazy"><br>
bigger than 10, keep it, else set it to other<br>
<img src="https://hiakkaoyri1220.com/post-images/1718727009645.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718727019433.png" alt="" loading="lazy"></p>
<h4 id="backwards">Backwards</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718727131315.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718727170766.png" alt="" loading="lazy"><br>
if any p-values greater than 0.05, find the largest and then remove it.</p>
<h4 id="backwards-using-aic">Backwards using AIC</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718727252519.png" alt="" loading="lazy"><br>
it looks bigger, than</p>
<h4 id="forwards-using-aic">Forwards using AIC</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718728975436.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718729034646.png" alt="" loading="lazy"><br>
pick the smallest one.</p>
<h4 id="both">Both</h4>
<p><img src="https://hiakkaoyri1220.com/post-images/1718729442326.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718729389663.png" alt="" loading="lazy"></p>
<h4 id="rmse">RMSE</h4>
<p>pick the smaller one<br>
<img src="https://hiakkaoyri1220.com/post-images/1718729503949.png" alt="" loading="lazy"></p>
<h1 id="week-12">Week 12</h1>
<h2 id="the-geometry-of-least-squares">The Geometry of Least Squares</h2>
<figure data-type="image" tabindex="95"><img src="https://hiakkaoyri1220.com/post-images/1718730193966.png" alt="" loading="lazy"></figure>
<h3 id="overview-2">Overview</h3>
<figure data-type="image" tabindex="96"><img src="https://hiakkaoyri1220.com/post-images/1718730235400.png" alt="" loading="lazy"></figure>
<h3 id="subspace">Subspace</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718730255998.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730282748.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730295605.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730309221.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730336905.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730392115.png" alt="" loading="lazy"></p>
<h3 id="vector-subspaces">Vector subspaces</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718730444373.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730490696.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730508755.png" alt="" loading="lazy"></p>
<h3 id="span">Span</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718730537988.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730598039.png" alt="" loading="lazy"></p>
<h3 id="basis">Basis</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718730646311.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730689359.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730738199.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730783175.png" alt="" loading="lazy"></p>
<h3 id="alternative-bases">Alternative Bases</h3>
<figure data-type="image" tabindex="97"><img src="https://hiakkaoyri1220.com/post-images/1718730802715.png" alt="" loading="lazy"></figure>
<h3 id="dimension-of-a-subspace">Dimension of a subspace</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718730838511.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730853265.png" alt="" loading="lazy"></p>
<h3 id="linear-models">Linear Models</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718730896580.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718730922981.png" alt="" loading="lazy"></p>
<h3 id="the-projection-matrix">The projection matrix</h3>
<figure data-type="image" tabindex="98"><img src="https://hiakkaoyri1220.com/post-images/1718730998619.png" alt="" loading="lazy"></figure>
<h3 id="the-orthogonal-complement">The Orthogonal Complement</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718731044230.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731083463.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731102738.png" alt="" loading="lazy"></p>
<h3 id="orthogonal-projection">Orthogonal Projection</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718731171434.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731210314.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731238742.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731249732.png" alt="" loading="lazy"></p>
<h3 id="the-least-squares-property">The least squares property</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718731278353.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731316893.png" alt="" loading="lazy"></p>
<h3 id="the-normal-equation">The normal equation</h3>
<figure data-type="image" tabindex="99"><img src="https://hiakkaoyri1220.com/post-images/1718731368558.png" alt="" loading="lazy"></figure>
<h3 id="symmetry-and-idempotence">Symmetry and Idempotence</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718731403002.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731574267.png" alt="" loading="lazy"></p>
<h3 id="the-matrix-formulation">The matrix formulation</h3>
<figure data-type="image" tabindex="100"><img src="https://hiakkaoyri1220.com/post-images/1718731433765.png" alt="" loading="lazy"></figure>
<h3 id="test-of-hypotheses-and-anova">Test of Hypotheses and ANOVA</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718731465069.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731479218.png" alt="" loading="lazy"></p>
<h3 id="the-expected-mean-squares">The expected mean squares</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718731500306.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731597620.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731705913.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731734395.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731748620.png" alt="" loading="lazy"></p>
<h3 id="the-f-statistic">The F-statistic</h3>
<figure data-type="image" tabindex="101"><img src="https://hiakkaoyri1220.com/post-images/1718731770597.png" alt="" loading="lazy"></figure>
<h3 id="geometry-of-generalised-least-squares">Geometry of generalised least squares</h3>
<p><img src="https://hiakkaoyri1220.com/post-images/1718731839959.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731877533.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731898803.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1718731913905.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[bayes test and assignment]]></title>
        <id>https://hiakkaoyri1220.com/post/bayes-test-and-assignment/</id>
        <link href="https://hiakkaoyri1220.com/post/bayes-test-and-assignment/">
        </link>
        <updated>2023-11-04T09:33:23.000Z</updated>
        <content type="html"><![CDATA[<h1 id="a1">A1</h1>
<h2 id="q1">Q1</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699193375448.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699193400253.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699193409840.png" alt="" loading="lazy"></p>
<h2 id="q2">Q2</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699193474674.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699193511026.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699814465398.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699288807439.png" alt="" loading="lazy"><br>
bigger <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span> minus smaller <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span>, that is what <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>μ</mi><mn>2</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mu_2-\mu_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> come<br>
<img src="https://hiakkaoyri1220.com/post-images/1699288817526.png" alt="" loading="lazy"></p>
<h2 id="q3">Q3</h2>
<figure data-type="image" tabindex="1"><img src="https://hiakkaoyri1220.com/post-images/1699193534295.png" alt="" loading="lazy"></figure>
<h2 id="q4">Q4</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699193546698.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699193556224.png" alt="" loading="lazy"></p>
<h1 id="t1">T1</h1>
<h2 id="q1-2">Q1</h2>
<p>You are asked to specify a prior for the variance in some data. What distribution would you choose?       <em><strong>Gamma or inv Gamma</strong></em><br>
You are asked to specify a data distribution for satellite observations of plane locations. What distribution do you choose for the plane locations? <em><strong>Normal</strong></em><br>
You are asked to specify a prior for the proportion of students who collaborate on tests. What prior do you select? <em><strong>Beta</strong></em></p>
<h2 id="q3-2">Q3</h2>
<figure data-type="image" tabindex="2"><img src="https://hiakkaoyri1220.com/post-images/1699253052922.png" alt="" loading="lazy"></figure>
<h2 id="q4-2">Q4</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699253510170.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699253500513.png" alt="" loading="lazy"></p>
<h2 id="q5">Q5</h2>
<figure data-type="image" tabindex="3"><img src="https://hiakkaoyri1220.com/post-images/1699253922905.png" alt="" loading="lazy"></figure>
<h1 id="a2">A2</h1>
<h2 id="q1-3">Q1</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699698876070.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699699102151.png" alt="" loading="lazy"></p>
<h2 id="q2-2">Q2</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699699309809.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699699319161.png" alt="" loading="lazy"><br>
where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span> may consider as nusiance parameter and ignore it.<br>
<img src="https://hiakkaoyri1220.com/post-images/1699710305831.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699709942883.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699772712949.png" alt="" loading="lazy"></p>
<h2 id="q3-3">Q3</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699711518509.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699711533652.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699711738825.png" alt="" loading="lazy"></p>
<h2 id="q4-3">Q4</h2>
<figure data-type="image" tabindex="4"><img src="https://hiakkaoyri1220.com/post-images/1699712007730.png" alt="" loading="lazy"></figure>
<h1 id="t2">T2</h1>
<h2 id="q1-4">Q1</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699804101182.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804089530.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804116347.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804130837.png" alt="" loading="lazy"></p>
<h2 id="q2-3">Q2</h2>
<p>predictor is what parameter is,<br>
hierarchical is seeing model to determine whether prior depends on something<br>
prior are the model use<br>
fix parameter are the known variable in likelihood in model<br>
<img src="https://hiakkaoyri1220.com/post-images/1699804188037.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804281464.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804504686.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804514837.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804715381.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804860196.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699804884537.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699805036138.png" alt="" loading="lazy"></p>
<h1 id="a3">A3</h1>
<h2 id="q1-5">Q1</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699810392974.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699810431219.png" alt="" loading="lazy"></p>
<h2 id="q2-4">Q2</h2>
<figure data-type="image" tabindex="5"><img src="https://hiakkaoyri1220.com/post-images/1699810910852.png" alt="" loading="lazy"></figure>
<h1 id="t3">T3</h1>
<h2 id="q1-6">Q1</h2>
<figure data-type="image" tabindex="6"><img src="https://hiakkaoyri1220.com/post-images/1699812559772.png" alt="" loading="lazy"></figure>
<h2 id="q2-5">Q2</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699813789318.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1699822520782.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Data science test and assignment]]></title>
        <id>https://hiakkaoyri1220.com/post/data-science-overview/</id>
        <link href="https://hiakkaoyri1220.com/post/data-science-overview/">
        </link>
        <updated>2023-11-03T07:07:56.000Z</updated>
        <content type="html"><![CDATA[<h1 id="test-1">Test 1</h1>
<h2 id="q1">Q1</h2>
<figure data-type="image" tabindex="1"><img src="https://hiakkaoyri1220.com/post-images/1698991556479.png" alt="" loading="lazy"></figure>
<h3 id="answerlist">Answerlist</h3>
<ol>
<li>Treatment A has the largest median</li>
<li>Treatment B has the largest IQR</li>
<li>Treatment C has no outliers</li>
<li>All of the groups are roughly symmetric<br>
###Solution</li>
<li>False. The group with the largest median is C</li>
<li>True. The group with the largest IQR is B (can see B's IQR position is biggest)</li>
<li>False. Treatment C has 3 outliers</li>
<li>True. Yes, all of the groups are roughly symmetric</li>
</ol>
<h2 id="q2">Q2</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1698991677028.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1698991777055.png" alt="" loading="lazy"></p>
<h2 id="q3">Q3</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1698991894154.png" alt="" loading="lazy"><br>
KNN is non-parametric as it doesn't simplify the function using an assumed distribution</p>
<h2 id="q4">Q4</h2>
<figure data-type="image" tabindex="2"><img src="https://hiakkaoyri1220.com/post-images/1698992175502.png" alt="" loading="lazy"></figure>
<ul>
<li>df |&gt; ggplot(aes(x, y)) + geom_point()<br>
<img src="https://hiakkaoyri1220.com/post-images/1698992209570.png" alt="" loading="lazy"></li>
<li>df |&gt; ggplot(aes(y, x, col = Tx)) + geom_point()<br>
<img src="https://hiakkaoyri1220.com/post-images/1698992224183.png" alt="" loading="lazy"></li>
<li>df |&gt; ggplot(aes(x, y, shape = Tx)) + geom_point()<br>
<img src="https://hiakkaoyri1220.com/post-images/1698992237942.png" alt="" loading="lazy"></li>
<li>df |&gt; ggplot(aes(Tx, y, size = x)) + geom_point()<br>
<img src="https://hiakkaoyri1220.com/post-images/1698992250541.png" alt="" loading="lazy"></li>
</ul>
<h2 id="q5">Q5</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1698992686766.png" alt="" loading="lazy"><br>
calculate all the point using Euclidean  distance then pick the min 3 and get average<br>
<img src="https://hiakkaoyri1220.com/post-images/1698992701974.png" alt="" loading="lazy"></p>
<h2 id="q6">Q6</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1698993017197.png" alt="" loading="lazy"><br>
Which model is that corresponding to a neighbourhood of 10?</p>
<ul>
<li>M1</li>
<li>M2</li>
</ul>
<h3 id="solution">Solution</h3>
<p>A neighbourhood of 10 would be less wigglerly, hence M2.</p>
<h2 id="q7">Q7</h2>
<figure data-type="image" tabindex="3"><img src="https://hiakkaoyri1220.com/post-images/1698993068780.png" alt="" loading="lazy"></figure>
<h3 id="solution-2">Solution</h3>
<p>You can find the median by looking at the column labelled p50 which in the case of cyl is 6.</p>
<h2 id="q8">Q8</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1698993128085.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1698993140873.png" alt="" loading="lazy"></p>
<h2 id="q9">Q9</h2>
<p>The following code is run.</p>
<pre><code>data(mpg)
linear_reg() %&gt;%
set_engine('lm') %&gt;%
fit(hwy ~ trans + model + cyl, data = mpg)
</code></pre>
<p>Which of the following are features?</p>
<ul>
<li>class</li>
<li>cty</li>
<li>cyl</li>
<li>displ</li>
<li>drv</li>
<li>fl</li>
<li>hwy</li>
<li>manufacturer</li>
<li>model</li>
<li>trans</li>
<li>year</li>
</ul>
<h3 id="solution-3">Solution</h3>
<p>The predictors are the variables given to the right of the ~, in this case<br>
&quot;trans&quot; &quot;model&quot; &quot;cyl&quot;</p>
<h2 id="q10">Q10</h2>
<p>A data set has 14 numeric variables and 18 categorical variables.<br>
If the data scientist wants to produce side-by-side box-plots for each combination of the appropriate variables, calculate how many side-by-side box-plots they will make.</p>
<h3 id="solution-4">Solution</h3>
<p>The number of possible variables for the y-axis is the 14 numeric variables, and the number of variables on the x-axis is 18, and hence the total number of box-plots is</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>14</mn><mo>×</mo><mn>18</mn><mo>=</mo><mn>252</mn></mrow><annotation encoding="application/x-tex">14 \times 18 = 252
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">2</span></span></span></span></span></p>
<h2 id="q11">Q11</h2>
<figure data-type="image" tabindex="4"><img src="https://hiakkaoyri1220.com/post-images/1698993341818.png" alt="" loading="lazy"></figure>
<h2 id="q12">Q12</h2>
<figure data-type="image" tabindex="5"><img src="https://hiakkaoyri1220.com/post-images/1698993393896.png" alt="" loading="lazy"></figure>
<h3 id="solution-5">Solution</h3>
<figure data-type="image" tabindex="6"><img src="https://hiakkaoyri1220.com/post-images/1698993412769.png" alt="" loading="lazy"></figure>
<h2 id="q13">Q13</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1699011721505.png" alt="" loading="lazy"><br>
more like 50% therefore is M1</p>
<h2 id="q14">Q14</h2>
<figure data-type="image" tabindex="7"><img src="https://hiakkaoyri1220.com/post-images/1699021540573.png" alt="" loading="lazy"></figure>
<h1 id="a1">A1</h1>
<h2 id="q1-2">Q1</h2>
<figure data-type="image" tabindex="8"><img src="https://hiakkaoyri1220.com/post-images/1699995291860.png" alt="" loading="lazy"></figure>
<h2 id="q2-2">Q2</h2>
<figure data-type="image" tabindex="9"><img src="https://hiakkaoyri1220.com/post-images/1699995864718.png" alt="" loading="lazy"></figure>
<h2 id="q3-2">Q3</h2>
<figure data-type="image" tabindex="10"><img src="https://hiakkaoyri1220.com/post-images/1699996212174.png" alt="" loading="lazy"></figure>
<h2 id="q4-2">Q4</h2>
<figure data-type="image" tabindex="11"><img src="https://hiakkaoyri1220.com/post-images/1699996573256.png" alt="" loading="lazy"></figure>
<h1 id="test-2">Test 2</h1>
<h2 id="q1-3">Q1</h2>
<figure data-type="image" tabindex="12"><img src="https://hiakkaoyri1220.com/post-images/1700003905209.png" alt="" loading="lazy"></figure>
<h2 id="q2-3">Q2</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1700003931264.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1700003963936.png" alt="" loading="lazy"><br>
2.9</p>
<h2 id="q3-3">Q3</h2>
<figure data-type="image" tabindex="13"><img src="https://hiakkaoyri1220.com/post-images/1700004139409.png" alt="" loading="lazy"></figure>
<h2 id="q4-3">Q4</h2>
<figure data-type="image" tabindex="14"><img src="https://hiakkaoyri1220.com/post-images/1700004181090.png" alt="" loading="lazy"></figure>
<h2 id="q5-2">Q5</h2>
<figure data-type="image" tabindex="15"><img src="https://hiakkaoyri1220.com/post-images/1700004485899.png" alt="" loading="lazy"></figure>
<h2 id="q6-2">Q6</h2>
<figure data-type="image" tabindex="16"><img src="https://hiakkaoyri1220.com/post-images/1700004536357.png" alt="" loading="lazy"></figure>
<h2 id="q7-2">Q7</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1700007943949.png" alt="" loading="lazy"><br>
add diagonal together</p>
<h2 id="q8-2">Q8</h2>
<figure data-type="image" tabindex="17"><img src="https://hiakkaoyri1220.com/post-images/1700008085122.png" alt="" loading="lazy"></figure>
<h1 id="a2">A2</h1>
<h2 id="q1-4">Q1</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1700009884039.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1700009899818.png" alt="" loading="lazy"></p>
<h2 id="q2-4">Q2</h2>
<figure data-type="image" tabindex="18"><img src="https://hiakkaoyri1220.com/post-images/1700010061806.png" alt="" loading="lazy"></figure>
<h1 id="t3">T3</h1>
<h2 id="q1-5">Q1</h2>
<figure data-type="image" tabindex="19"><img src="https://hiakkaoyri1220.com/post-images/1700010322952.png" alt="" loading="lazy"></figure>
<h2 id="q2-5">Q2</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1700010350796.png" alt="" loading="lazy"><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mrow><mo>(</mo><mn>3</mn><mo>×</mo><mn>2</mn><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">2^{(3 \times 2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mbin mtight">×</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="q3-4">Q3</h2>
<figure data-type="image" tabindex="20"><img src="https://hiakkaoyri1220.com/post-images/1700010467232.png" alt="" loading="lazy"></figure>
<h2 id="q4-4">Q4</h2>
<p><img src="https://hiakkaoyri1220.com/post-images/1700010530514.png" alt="" loading="lazy"><br>
$(5 \times 13 + 6 )/ 14 - 5</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[解题报告]]></title>
        <id>https://hiakkaoyri1220.com/post/jie-ti-bao-gao/</id>
        <link href="https://hiakkaoyri1220.com/post/jie-ti-bao-gao/">
        </link>
        <updated>2023-10-14T05:58:48.000Z</updated>
        <content type="html"><![CDATA[<h1 id="903">903</h1>
<h2 id="d">D</h2>
<p>比较思维的一个题，我们直接入手非常困难，我们不可能去模拟这变换的过程。<br>
我们需要找寻突破口，对于这种模拟很复杂的题，变化情况很多的题，我们可以尝试寻找其中的不变量。<br>
那么什么是不变的呢？我们发现对于一次操作：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mfrac><msub><mi>a</mi><mi>i</mi></msub><mi>x</mi></mfrac><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo>=</mo><msub><mi>a</mi><mi>j</mi></msub><mo>×</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">a_i = \frac{a_i}{x} , a_j = a_j \times x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></span></p>
<p>本质上，我们发现他只是发生了因子之间的转移，相当于我把<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的一个因子除去，然后乘到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">a_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>上。我们发现本质是在进行因子的转移，那么意味着整个数组的质因子个数一定不会变化。<br>
那么我们假设数组中有一个质因子<em>p</em>出现了<em>x</em> 次，我们最终要把所有数弄成一样，是不是意味着，此时我数组每一个数的质因子次幂必须完全一样。相当于我们必须把这<em>x</em>个质因子，分成<em>n</em>组，每组的个数都得一样。<br>
所以对于数组中所有的不同质因子<em>p</em>，其出现次数为<em>x</em>，都满足 <em>s %n == 0</em></p>
<pre><code>#include&lt;bits/stdc++.h&gt;
#define pb push_back
#define eb emplace_back
typedef long long ll;
using namespace std;
int n,t;
int a[10010],c[1000010];
	int main(){
	  ios::sync_with_stdio(false); cin.tie(0);
	  cin&gt;&gt;t;
	  while(t--)
	  {
	  	cin&gt;&gt;n;
	  	int m=0;
	  	memset(c,0,sizeof c);
	  	for(int i=1;i&lt;=n;++i) {cin&gt;&gt;a[i];}
	  	vector&lt;int&gt;p;
	  	for(int k=1;k&lt;=n;++k)
	  	{
	  		int x=a[k];
		  	for(int i=2;i*i&lt;=x;++i)
		  	{
		  		if(x%i==0)
		  		{
		  			if(c[i]==0)p.pb(i);
		  			// c[i]++;
		  			while(x%i==0)
		  			{
		  				x/=i;
		  				c[i]++;
		  			}
		  		}
		  	}
		  	if(x &gt;1)
		  	{
	  			if(c[x]==0)p.pb(x);
	  			c[x]++;
		  	}
		}
		// for(int i=0;i&lt;p.size();++i)
		// 	cout&lt;&lt;p[i]&lt;&lt;&quot;^&quot;&lt;&lt;c[p[i]]&lt;&lt;&quot; &quot;&lt;&lt;t&lt;&lt;endl;
	  	bool yes =true;
		for(int i=0;i&lt;p.size();++i)
		{
			if(c[p[i]]%n!=0)
			{
				yes =false;
				break;
			}
		}
		if(yes)cout&lt;&lt;&quot;YES&quot;&lt;&lt;endl;
		else cout&lt;&lt;&quot;NO&quot;&lt;&lt;endl;
	  }
	return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[mysql base]]></title>
        <id>https://hiakkaoyri1220.com/post/mysql-base/</id>
        <link href="https://hiakkaoyri1220.com/post/mysql-base/">
        </link>
        <updated>2023-09-12T07:36:43.000Z</updated>
        <content type="html"><![CDATA[<h3 id="create-database">create database</h3>
<pre><code>CREATE DATABASE dbname;
</code></pre>
<h3 id="use-this-database">use this database</h3>
<pre><code>USE DATABASE;
</code></pre>
<h3 id="drop-database-or-table">drop database or table</h3>
<pre><code>DROP DATABASE databasename;
DROP TABLE table_name;
</code></pre>
<h3 id="modifying-tables">Modifying tables</h3>
<pre><code>/* Add a column */
ALTER TABLE tablename
ADD columnname1 datatype constraint;
/* Change a column */
ALTER TABLE tablename
ALTER columnname1 newdatatype newconstraint;
/* Delete a column */
ALTER TABLE tablename
DROP columnname1;
</code></pre>
<p>###Adding data</p>
<pre><code>/* Okay to leave out columns */
INSERT INTO tablename
VALUES (value1, value2, value3);
</code></pre>
<h3 id="updating-data">updating data</h3>
<pre><code>UPDATE table_name
SET columnname = value;
</code></pre>
<h3 id="filtering-data-with-where">filtering data with where</h3>
<pre><code>Use the UPDATE + WHERE to only update some rows
UPDATE table_name
SET columnname = value
WHERE columnname &gt; 5;
Use the DELETE + WHERE to only delete some rows
DELETE FROM table_name
WHERE columnname IS NULL;
</code></pre>
<pre><code>DELETE FROM table_name
WHERE column1 &gt; 1200 AND (column2 = 'hello' OR column3 IS NOT NULL);
</code></pre>
<h3 id="finding-data">finding data</h3>
<pre><code>SELCT * FROM table_name WHERE column1 IS NULL;
</code></pre>
<h3 id="find-data-across-table">find data across table</h3>
<pre><code>SELECT * FROM tableA INNER JOIN tableB
ON tableA.column1 = tableA.column2
WHERE column3 = 'Hello';
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[useful]]></title>
        <id>https://hiakkaoyri1220.com/post/useful/</id>
        <link href="https://hiakkaoyri1220.com/post/useful/">
        </link>
        <updated>2023-08-04T05:53:14.000Z</updated>
        <content type="html"><![CDATA[<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><msup><mo>)</mo><mn>2</mn></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo>)</mo><mn>2</mn></msup><mo>+</mo><mi>n</mi><mo>(</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mo>−</mo><mi>μ</mi><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{n} (x_i -\mu)^2 = \sum_{i=1}^{n} (x_i -\overline{x})^2 + n(\overline{x} -\mu)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">μ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">μ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\overline{x} = \frac{1}{n} \sum_{i=1}^{n} x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63056em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中间加上 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mn>2</mn><mi>n</mi><msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><mi>n</mi><msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mn>2</mn></msup><mo>+</mo><mi>n</mi><msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">-2n\overline{x}^2+n\overline{x}^2+n\overline{x}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.917898em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.834568em;"><span style="top:-3.08346em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.917898em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.834568em;"><span style="top:-3.08346em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.834568em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.834568em;"><span style="top:-3.08346em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>就可以构成<br>
<img src="https://hiakkaoyri1220.com/post-images/1691139744717.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1691746345454.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1691747001644.png" alt="" loading="lazy"></p>
<ol>
<li>p for &quot;probability&quot;, the cumulative distribution function (c. d. f.)</li>
<li>q for &quot;quantile&quot;, the inverse c. d. f.</li>
<li>d for &quot;density&quot;, the density function (p. f. or p. d. f.)</li>
<li>r for &quot;random&quot;, a random variable having the specified distribution<br>
<img src="https://hiakkaoyri1220.com/post-images/1691760614730.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1694884390619.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1695058083392.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709443721076.png" alt="" loading="lazy"><br>
<img src="https://hiakkaoyri1220.com/post-images/1709358429034.png" alt="" loading="lazy"></li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[bayes prac]]></title>
        <id>https://hiakkaoyri1220.com/post/bayes-prac/</id>
        <link href="https://hiakkaoyri1220.com/post/bayes-prac/">
        </link>
        <updated>2023-07-29T01:57:05.000Z</updated>
        <content type="html"><![CDATA[<h2 id="practical-1">Practical 1</h2>
<p>study of visitors to Belair National park in July 2019 found that 33018 South Australian visitors booked<br>
a ticket. In the same month, 1205 mobile signals from South Australians were detected in the park.<br>
Assume that the bookings, n = 33018, were the total number of visitors. Treat y = 1205 as the number of<br>
successes. Your model is the Beta prior with binomial likelihood:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mo>∝</mo><msup><mi>θ</mi><mrow><mi mathvariant="normal">ℵ</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><msup><mo>)</mo><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P(\theta) \propto \theta^{\aleph-1}(1-\theta)^{\beta-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">ℵ</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>and</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>y</mi><mo>∣</mo><mi>θ</mi><mo>)</mo><mo>∝</mo><msup><mi>θ</mi><mi>y</mi></msup><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><msup><mo>)</mo><mrow><mi>n</mi><mo>−</mo><mi>y</mi></mrow></msup></mrow><annotation encoding="application/x-tex">P(y \mid \theta) \propto \theta^{y}(1-\theta)^{n-y}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714392em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Compute un-normalised posteriors and then normalise them<br>
Note: you know or at least can calculate the posterior distribution for this problem. Please don’t do so yet.</p>
<ol>
<li>Write code that saves the values of alpha, beta, n and y as constants. Discretise theta: represent<br>
it by at least 100 points between 0 and 1 (e.g. by using seq()). Calculate the product of the prior<br>
and likelihood, using my functions above for each. This is an (un-normalised) posterior. What is the<br>
maximum value that it takes?</li>
</ol>
<pre><code>alpha &lt;- 1
beta &lt;- 1
n &lt;- 33018
y &lt;- 1205
theta &lt;- seq(0,1,by=0.01)
prior &lt;- thetaˆ(alpha-1) * (1-theta)ˆ(beta-1) # or dbeta(theta, alpha, beta)
likelihood &lt;- thetaˆy * (1-theta)ˆ(n-y)
#note dbinom(y,n,theta) does not work with vector theta input
posterior &lt;- prior*likelihood
df &lt;- tibble(theta,prior,likelihood,posterior)
ggplot(df,aes(theta,posterior))+ geom_line()
</code></pre>
<h3 id="work-with-the-conjugate-prior">Work with the conjugate prior</h3>
<p>For the example of this prac, the posterior is<br>
θ|y ∼ Beta(α + y, β + n − y) .</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \belong at position 13: \theta \mid \̲b̲e̲l̲o̲n̲g̲
̲'>\theta \mid \belong
</p>
<ol>
<li>Using an appropriate function (dbeta in R), compute the posterior pdf on your theta.</li>
</ol>
<pre><code>posterior_conj &lt;- dbeta(theta,alpha+y, beta+n-y)
df &lt;- df %&gt;% add_column(posterior_conj)
df %&gt;% pivot_longer(-theta) %&gt;% ggplot(aes(theta,value,color=name)) + geom_line()
</code></pre>
<h2 id="practical-2">Practical 2</h2>
<h3 id="拒绝采样">拒绝采样</h3>
<p>对于一个难以采样的后验分布，我们可以通过给定一个目标 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>,使得目标分布能够包含分布<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span> 并找到 最好的<em>k</em>使得 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>∗</mo><mi>p</mi><mi>o</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi><mi mathvariant="normal">/</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>a</mi><mi>l</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K * posterior / proposal &lt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>， 一般来讲 proposal  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>都会采取均匀分布<br>
<img src="https://hiakkaoyri1220.com/post-images/1692964144510.png" alt="" loading="lazy"><br>
随机生成x坐标，然后求出概率 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>∗</mo><mi>f</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi>g</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">K*f(\theta) / g(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>)-&gt; 后验的分布函数值，最后基于x坐标上随机生成y坐标，若当前y坐标小于后验的分布函数值，则接受。<br>
Generates 100000 random number in the range of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1.5</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[-1,1.5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">]</span></span></span></span><br>
<code>runif(100000,-1,1.5)</code><br>
95% CI<br>
<code>quantile(accepted_samples,c(0.025,0.975)) #95% CI for mu</code></p>
<h3 id="reject-sampling-code-and-link">Reject sampling code and link</h3>
<p><a href="https://gaolei786.github.io/statistics/reject.html">introduction</a></p>
<pre><code>pacman::p_load(
  tidyverse,
  tidymodels,
  vip
)
football &lt;-read_delim(here::here(&quot;data&quot;,&quot;football.txt&quot;))
football

new_football &lt;-
  football%&gt;%
  transmute(diff =favorite-underdog-spread)

new_football
#oo &lt;-
  #new_football%&gt;%
summ&lt;-summarise(new_football,mean = mean(diff),s.d = sd(diff))
new_football%&gt;%
  ggplot(aes(diff))+
  geom_histogram()

N &lt;- 100000 #number of samples from proposal
mu_proposals &lt;- runif(N,-1,1.5)#started with wide bounds for the proposals, then narrowed them
n&lt;-nrow(new_football)
x_bar&lt;-summ$mean
sigma&lt;-13.7
#At this stage we need K such that Kf (x)/g(x) ≤ 1 for all x. Here f (x) is the posterior, and g(x) is the
#proposal.
#Let me sub in the functions and write that out as a very similar problem.
#̃K exp
#[
#  − (mu_proposals −  ̄x)2
#  2σ2/n
#]
#≤ 1.
#I need to find  ̃K such that the above line is true. You might be confused - what is  ̃K? Answer: I absorbed
#all of the normalising constants for the functions f (x) and g(x) into K. This is the step that I imagine takes
#everyone off guard.
#Try saying the following: if there is a  ̃K satisfying the second equation, then there is a K satisfying the first
#equation. The only difference between the two is the normalising constants for f (x) and g(x). But, to use
#the algorithm I only need to know Kf (x)/g(x), and that is the same thing as
#̃K exp
#[
#  − (mu_proposals −  ̄x)2
 # 2σ2/n
#]
#.
#Now we identify  ̃K: since the left-hand-side of the inequality is e−a2
#, it already is ≤ 1 and I can choose
#̃K = 1. Compute Kf (x)/g(x) for each sample.

# compute K*f/g
Kfgs &lt;- exp(-(mu_proposals-x_bar)^2/(2*sigma^2/n))
probs &lt;- runif(N)
accepted_samples &lt;- mu_proposals[probs &lt; Kfgs]
length(accepted_samples)/N # We accept about 30% of samples
#4. Formally we require g(μ) &gt; 0 whenever f (μ) &gt; 0. Is this assumption satisfied? Is there a problem?
#  Solutions:
#  No - the posterior is formally supported on μ ∈ R but the proposal has defined lower and upper bounds.
#However, not a practical problem. If the lower bound for the proposal density is larger than 1, or if the
#upper bound for the proposal density is smaller than about 1.5, then you may cut off significant parts of the
#posterior (try it). As long as your proposal is supported on at least [-1,1.5], you get well over 99% of the
#posterior mass.

accepted_samples %&gt;% as_tibble() %&gt;% ggplot(aes(accepted_samples, y=..density..)) + geom_histogram()
quantile(accepted_samples,c(0.025,0.975)) #95% CI for mu
</code></pre>
<p>filter the wanted information and change date to year only<br>
<code>ad_temp &lt;- temperature %&gt;% filter(city_name==&quot;PORT&quot; &amp; date &gt; &quot;2004-12-31&quot; &amp; date &lt; &quot;2015-01-01&quot;) ad_temp &lt;- ad_temp %&gt;% mutate( date = year(date)) #save the date as year only</code><br>
group by date and get the mean within valid date<br>
remove missing value by using na.rm =TRUE<br>
<code>tem1&lt;-   tem%&gt;%   group_by(date)%&gt;%   summarise(Mean = mean(temperature, na.rm=TRUE))</code><br>
generate 1 iid value with corrsponde mean and sd<br>
<code>rnorm(1 , mu_mn, mu_sd(mu_sigma[i-1,2])</code></p>
<h1 id="week3-gibbs-sampler">Week3 gibbs sampler</h1>
<p>吉布斯采样：对于一个难以采样的联合分布函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>，假设它的条件函数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>x</mi><mo>∣</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(x \mid y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>和<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>y</mi><mo>∣</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(y \mid x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>能够轻易采样,则我们可以通过交替条件来进行采样.这意味着相应的变量会在迭代的过程中交替使用.</p>
<h3 id="procedure">procedure</h3>
<p>给定一个难以采样的联合后验分布,我们希望通过gibse sampler来为我们进行采样</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>x</mi><mo>∣</mo><msub><mi>θ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>)</mo><mo>∝</mo><msubsup><mi>θ</mi><mn>1</mn><mi>x</mi></msubsup><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>θ</mi><mn>1</mn></msub><msup><mo>)</mo><mrow><mn>100</mn><mo>−</mo><mi>x</mi></mrow></msup><msubsup><mi>θ</mi><mn>2</mn><mi>x</mi></msubsup><msup><mi>exp</mi><mo>⁡</mo><mrow><mo>−</mo><msub><mi>θ</mi><mn>2</mn></msub></mrow></msup></mrow><annotation encoding="application/x-tex">p(x \mid \theta_1,\theta_2) \propto \theta_1^x(1-\theta_1)^{100-x}\theta_2^x \exp^{-\theta_2} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">exp</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>假设我们已知他们的条件分布函数为</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo>∣</mo><mi>x</mi><mo>∼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>(</mo><mn>2</mn><mo>+</mo><mi>x</mi><mo separator="true">,</mo><mn>103</mn><mo>−</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\theta_1 \mid x \sim Beta(2+x,103-x)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub><mo>∣</mo><mi>x</mi><mo>∼</mo><mi mathvariant="normal">Γ</mi><mo>(</mo><mi>x</mi><mo>+</mo><mn>0.5</mn><mo separator="true">,</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">\theta_2 \mid x \sim \Gamma(x+0.5,1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Γ</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<p>则我们可以通过对10000个样本进行采样,并给<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">X_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>设置一个随机初值,以观测值<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>作为条件从而推断出后验分布。</p>
<pre><code>N &lt;- 10000 #how many samples to take
thetas=matrix(1,nrow=N,ncol=2) #initialise matrix to save our output. This is a good step philosophicall
for(i in 2:N){
thetas[i,1]=rbeta(1, 2+data, 103-data )
thetas[i,2]=rgamma(1,data+0.5,1)
}
</code></pre>
<h3 id="example">example</h3>
<p>需要注意的是有的条件函数可能会基于当前时间的另外一个参数<br>
<img src="https://hiakkaoyri1220.com/post-images/1693027239255.png" alt="" loading="lazy"></p>
<pre><code>rho=0.75 #correlation
#initialise matrix for samples
theta=matrix(0,nrow=200,ncol=2)
#sample from conditional distributions
for(i in 2:200){
#sample time i, component 1 using time i-1, component 2
theta[i,1]=rnorm(1,rho*theta[i-1,2],sqrt(1-rhoˆ2))
#sample time i, component 2 using i,1
theta[i,2]=rnorm(1,rho*theta[i,1],sqrt(1-rhoˆ2))
}
</code></pre>
<h3 id="问题1">问题1</h3>
<p>对于 MCMC, 我们给马尔科夫链所假设的初值不一定是正确的.尽管最后的数据会趋于收敛.但丢掉一些马尔可夫链的初始步骤可以消除所谓的“磨合期”，即链中有不成比例的许多样本<br>
低概率区域</p>
<h3 id="问题2">问题2</h3>
<p>如果我们的样本长时间保持相关性，那么看起来像许多样本(100多个)，<br>
实际上可能相当于更少的不相关样本</p>
<h3 id="对于相关性的plot">对于相关性的plot</h3>
<pre><code>pacman::p_load(bayesforecast) #contains a ggplot style acf
ggacf(mu_sigma) #formatted as a matrix:
</code></pre>
<h1 id="week-4-metropolis-hastings-algorithm">Week 4 Metropolis-Hastings algorithm</h1>
<p>When implementing M-H, you need to to know</p>
<ol>
<li>the posterior density/mass function up to some proportionality constant.</li>
<li>to have a proposal distribution in mind to move around samples of the posterior variables</li>
</ol>
<h3 id="the-second-point-breaks-down-as-follows">The second point breaks down as follows:</h3>
<ol>
<li>Choose a rule to move your samples around. I will be estimating variables <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>. let <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mo>(</mo></msup><mi>t</mi><mo>)</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\theta^(t) \in \mathbb{R^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> be the t-th sample of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>μ</mi><mo separator="true">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(\mu,\sigma^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">μ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>: will use the proposal <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow></msup><mo>∣</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup><mo>∼</mo><mi>N</mi><mo>(</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup><mo separator="true">,</mo><mi>c</mi><mi>I</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\theta^{(t+1)} \mid \theta^{(t)} \sim N(\theta^{(t)},cI)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span> for some constant c.</li>
<li>write a function to take one sample of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\theta^{(t+1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> given an input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\theta^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>.</li>
</ol>
<pre><code>prop_sd &lt;- c(0.1,0.04) #These sds are ad hoc and must be tuned. 
# Once you understand the file, change these numbers and look at the acf plots!

#sample once for mu and once for sigma.
sample_proposal &lt;- function(sample){
  rnorm(2,mean=sample,sd=prop_sd)
} 
</code></pre>
<ol start="3">
<li>Write a function to evaluate the proposal density function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow></msup><mo>∣</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\theta^{(t+1)} \mid \theta^{(t)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> at a location given by proposal <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>θ</mi><mi mathvariant="normal">∗</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(\theta^∗)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, given an input sample <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(\theta^{(t)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</li>
</ol>
<pre><code>prop_dens &lt;- function(sample, proposal){
  prod(dnorm(proposal, mean=sample, sd=prop_sd))
  #above dnorm(...) calculates the density of the two gaussian proposal distributions
  #that is, for mu and for sig2
  #prod(dnorm(...)) finds the density of the proposal as a whole
} 
</code></pre>
<p>总结：对于Metropolis-Hastings算法</p>
<ol>
<li>我们先需要计算出我们的后验分布函数(包括忽略不必要的常数)</li>
<li>构造一个提议分布来移动后验变量的样本</li>
</ol>
<blockquote>
<ul>
<li>对于提议分布,第一步我们需要先确定它移动的规则,并创建一个函数去取取<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\theta^{(t+1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>的一个样本</li>
<li>给定输入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\theta^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> (也就是创建马尔科夫链,并使用随机生成分布函数(r开头的)去生成马尔科夫链)</li>
<li>创捷一个函数能够去评估提议密度函数,即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow></msup><mo>∣</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\theta^{(t+1)} \mid \theta^{(t)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 在提案<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>θ</mi><mi mathvariant="normal">∗</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(\theta^∗)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>给出的位置，给定输入示例<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>θ</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(\theta^{(t)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。</li>
</ul>
</blockquote>
<ol start="3">
<li>处理数据</li>
<li>选定合适的先验值,并计算出<em><strong>似然,先验分布和后验分布</strong></em></li>
<li>初始化矩阵</li>
<li>跑下面的板子</li>
<li>去除burn-in problem(也就是说要选定一个区间[1,???],去除里面的数据,并检查相关性.</li>
</ol>
<h2 id="code-for-metropolis-hastings">Code for Metropolis-Hastings</h2>
<p>generic code for Metropolis-Hastings.</p>
<pre><code>for(i in 2:N){
  #sample from proposal
  proposal &lt;- sample_proposal(samples[i-1,])
  
  #compute probability - possible to get Inf or NaN
  r &lt;- (post_exact( proposal ) /
    post_exact( samples[i-1,] )) *
    (prop_dens( proposal, samples[i-1,] ) /
    prop_dens( samples[i-1,], proposal ))
  
  # Possible to get NaNs, e.g. if the proposal is a negative variance. 
  r[is.nan(r)]=0 #reject. 
  
  #accept or reject step
  prob &lt;- runif(1,0,1)
  if( prob&lt;r ){ #then accept
    samples[i,] = proposal
    n_accept &lt;- n_accept+1
  } else {
    samples[i,] = samples[i-1,]
  } #end else
} #end for loop

#report the percent of accepted steps
percent_accept &lt;- 100*n_accept/N
percent_accept
</code></pre>
<h2 id="part-one-beta-binomial">Part One: Beta-Binomial</h2>
<p>In this part you connect Metropolis-Hastings output to your standard Bayesian conjugate priors.</p>
<h3 id="problem">Problem</h3>
<p>When recording the sex of babies born in Paris between 1745 and 1770, a total of 241,945 girls and 251,527<br>
boys were recorded. Laplace concluded that he was ‘morally certain’ that the probability <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> of birth sex being<br>
female was less than 0.5.<br>
Can you do any better?</p>
<ol>
<li>Formulate a binomial likelihood - what is n and what is x?<br>
n is the total number of people, 493472, while x is 241945.</li>
<li>Write down a prior. If you are feeling fancy, use the Fisher information in the binomial distribution to obtain the Jeffreys prior.<br>
Fisher information for the binomial distribution is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mo>(</mo><mi>θ</mi><mo>(</mo><mn>1</mn><mi mathvariant="normal">−</mi><mi>θ</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">n/(\theta(1 − \theta))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>, so the Jeffreys prior is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mo>∝</mo><msup><mi>θ</mi><mrow><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">p(\theta) \propto \theta^{-1/2}(1-\theta)^{-1/2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>Write a function, log_post, to compute the log of the posterior up to a constant.<br>
对后验分布进行log化</li>
</ol>
<pre><code>x &lt;- 241945
n &lt;- x + 251527
log_post &lt;- function(theta){
(x-1/2)*log(theta) + (n-x-1/2)*log(1-theta)
}
</code></pre>
<ol start="4">
<li>Implement Metropolis-Hastings to get samples from the posterior and plot a histogram. Use the following code to compute the probability <em>r</em> of keeping a sample:</li>
</ol>
<pre><code>#write a function to do MH:
mh_sampler &lt;- function(
    #inputs
  sample_proposal, #fun to sample from proposal
  prop_dens, #fun to evaluate proposal density
  log_post, #fun to evaluate log(posterior)
  initial_sample, #initial sample
  N = 5e4, #number of samples - default to 50,000
  burnin = 1e4 #burnin to remove - default 10,000 for safety
){
  #steps
  #initialise matrix for samples
  samples=matrix(0,nrow=N,ncol=length(initial_sample))
  samples[1,] = initial_sample
  n_accept &lt;- 0 #count how many proposal steps were accepted
  # Code for Metropolis-Hastings
  for(i in 2:N){
    #sample from proposal
    proposal &lt;- sample_proposal(samples[i-1,])
    #compute probability - possible to get Inf or NaN
    r &lt;- exp(log_post( proposal ) -
               log_post( samples[i-1,] )) *
      (prop_dens( proposal, samples[i-1,] ) /
         prop_dens( samples[i-1,], proposal ))
    # Possible to get NaNs, e.g. if the proposal is a negative variance.
    r[is.nan(r)]=0 #reject.
    #accept or reject step
    prob &lt;- runif(1,0,1)
    if( prob&lt;r ){ #then accept
      samples[i,] = proposal
      n_accept &lt;- n_accept+1
    } else {
      samples[i,] = samples[i-1,]
    } #end else
  } #end for loop
  #report the percent of accepted steps
  percent_accept &lt;- 100*n_accept/N
  #output percent of accepted samples
  print(paste(&quot;Percent of accepted samples: &quot;, percent_accept))
  #remove the burn-in
  samples_trunc &lt;- samples[-1:-burnin,]
  #output truncated samples
  return(samples_trunc)
} 
</code></pre>
<p>5.根据题目要求设计提议样本和提议密度</p>
<pre><code>prop_sd &lt;- 0.005
sample_proposal &lt;- function(theta){rnorm(1,mean=theta,sd=prop_sd)}
prop_dens &lt;- function(theta,proposal){
dnorm(proposal, mean=theta, sd=prop_sd)
}
</code></pre>
<ol start="6">
<li>检查相关性<br>
<code>ggacf(samples)</code></li>
</ol>
<h4 id="bad-correlation">bad correlation</h4>
<figure data-type="image" tabindex="1"><img src="https://hiakkaoyri1220.com/post-images/1693117010253.png" alt="" loading="lazy"></figure>
<h4 id="good-correlation">good correlation</h4>
<figure data-type="image" tabindex="2"><img src="https://hiakkaoyri1220.com/post-images/1693117018258.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
</feed>